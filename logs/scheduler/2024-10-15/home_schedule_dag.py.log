[2024-10-15T21:22:58.903+0530] {processor.py:186} INFO - Started process (PID=4910) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:22:58.904+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:22:58.905+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:22:58.905+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:23:06.998+0530] {logging_mixin.py:190} INFO - Reading the CSV file...
[2024-10-15T21:23:15.077+0530] {logging_mixin.py:190} INFO - CSV file loaded successfully!
[2024-10-15T21:23:15.077+0530] {logging_mixin.py:190} INFO - DataFrame Schema:
[2024-10-15T21:23:15.079+0530] {logging_mixin.py:190} INFO - root
 |-- id: string (nullable = true)
 |-- date: string (nullable = true)
 |-- price: double (nullable = true)
 |-- bedrooms: string (nullable = true)
 |-- bathrooms: string (nullable = true)
 |-- sqft_living: string (nullable = true)
 |-- sqft_lot: string (nullable = true)
 |-- floors: string (nullable = true)
 |-- waterfront: string (nullable = true)
 |-- view: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- grade: string (nullable = true)
 |-- yr_built: string (nullable = true)
 |-- zipcode: string (nullable = true)
 |-- lat: string (nullable = true)
 |-- long: string (nullable = true)
[2024-10-15T21:23:15.079+0530] {logging_mixin.py:190} INFO - First few rows of the DataFrame:
[2024-10-15T21:23:15.452+0530] {logging_mixin.py:190} INFO - +----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|    price|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|     NULL|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
| 629000615|20141022T000000|1495000.0|       4|     3.25|       3070|   10375|     2|        No|No View|  Average|   10|    1962|  98004|47.5862|-122.198|
|4141800215|20141126T000000|1495000.0|       4|     3.75|       3770|    4000|   2.5|        No|No View|Very Good|    9|    1916|  98122|47.6157|-122.287|
|6448000020|20150129T000000|1490000.0|       4|      2.5|       2420|   18480|     1|        No|No View|     Good|    9|    1967|  98004|47.6214|-122.227|
|9522300010|20150331T000000|1490000.0|       3|      3.5|       4560|   14608|     2|        No|Average|  Average|   12|    1990|  98034|47.6995|-122.228|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
only showing top 5 rows
[2024-10-15T21:23:16.061+0530] {logging_mixin.py:190} INFO - Calculating price statistics by zipcode...
[2024-10-15T21:23:17.568+0530] {logging_mixin.py:190} INFO - Price statistics saved to /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode
[2024-10-15T21:23:17.568+0530] {logging_mixin.py:190} INFO - Analyzing house features...
[2024-10-15T21:23:18.351+0530] {logging_mixin.py:190} INFO - House features analysis saved to /home/vboxuser/airflow/dags/analytics/house_features_analysis
[2024-10-15T21:23:18.352+0530] {logging_mixin.py:190} INFO - Analyzing condition and grade distribution...
[2024-10-15T21:23:19.044+0530] {logging_mixin.py:190} INFO - Condition and grade distribution saved to /home/vboxuser/airflow/dags/analytics/condition_distribution
[2024-10-15T21:23:19.045+0530] {logging_mixin.py:190} INFO - Analyzing waterfront properties...
[2024-10-15T21:23:19.756+0530] {logging_mixin.py:190} INFO - Waterfront analysis saved to /home/vboxuser/airflow/dags/analytics/waterfront_analysis
[2024-10-15T21:23:19.756+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv...
[2024-10-15T21:23:19.756+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv
[2024-10-15T21:23:19.757+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/house_features_analysis into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv...
[2024-10-15T21:23:19.758+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv
[2024-10-15T21:23:19.758+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/condition_distribution into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv...
[2024-10-15T21:23:19.759+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv
[2024-10-15T21:23:19.759+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/waterfront_analysis into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv...
[2024-10-15T21:23:19.760+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv
[2024-10-15T21:23:19.761+0530] {logging_mixin.py:190} INFO - Integrating with Google Drive...
[2024-10-15T21:23:19.774+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:23:19.773+0530] {__init__.py:49} INFO - file_cache is only supported with oauth2client<4.0.0
[2024-10-15T21:23:19.780+0530] {logging_mixin.py:190} INFO - Google Drive authentication successful!
[2024-10-15T21:23:19.780+0530] {logging_mixin.py:190} INFO - Deleting old files from Google Drive folder...
[2024-10-15T21:23:26.113+0530] {logging_mixin.py:190} INFO - Deleted file: waterfront_analysis_final.csv with ID: 1YvPbOfYU3ylGmiMnI07ASSzj5M-bDsqO
[2024-10-15T21:23:27.336+0530] {logging_mixin.py:190} INFO - Deleted file: condition_distribution_final.csv with ID: 1lxJZYDBTT0bnNqqdYcaxjM8jJh8QGfUM
[2024-10-15T21:23:28.479+0530] {logging_mixin.py:190} INFO - Deleted file: house_features_analysis_final.csv with ID: 1mvUY-JsQR3KHCr4dI3A5dhnbi0Grj5mR
[2024-10-15T21:23:28.913+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:23:28.912+0530] {timeout.py:68} ERROR - Process timed out, PID: 4910
[2024-10-15T21:23:28.933+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:23:28.914+0530] {dagbag.py:387} ERROR - Failed to import: /home/vboxuser/airflow/dags/home_schedule_dag.py
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/vboxuser/airflow/dags/home_schedule_dag.py", line 8, in <module>
    from home_analytics import perform_analytics  # Adjust the import based on your file name
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 197, in <module>
    perform_analytics()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 166, in perform_analytics
    delete_old_files()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 161, in delete_old_files
    service.files().delete(fileId=item['id']).execute()
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 923, in execute
    resp, content = _retry_request(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 191, in _retry_request
    resp, content = http.request(uri, method, *args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google_auth_httplib2.py", line 218, in request
    response, content = self.http.request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1725, in request
    (response, content) = self._request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1441, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1393, in _conn_request
    response = conn.getresponse()
  File "/usr/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/usr/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python3.10/http/client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/usr/lib/python3.10/ssl.py", line 1303, in recv_into
    return self.read(nbytes, buffer)
  File "/usr/lib/python3.10/ssl.py", line 1159, in read
    return self._sslobj.read(len, buffer)
  File "/usr/local/lib/python3.10/dist-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/vboxuser/airflow/dags/home_schedule_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#reducing-dag-complexity, PID: 4910
[2024-10-15T21:23:28.934+0530] {processor.py:927} WARNING - No viable dags retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:23:28.961+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 30.063 seconds
[2024-10-15T21:25:19.630+0530] {processor.py:186} INFO - Started process (PID=5912) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:25:19.632+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:25:19.634+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:25:19.634+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:25:24.561+0530] {logging_mixin.py:190} INFO - Reading the CSV file...
[2024-10-15T21:25:31.772+0530] {logging_mixin.py:190} INFO - CSV file loaded successfully!
[2024-10-15T21:25:31.778+0530] {logging_mixin.py:190} INFO - DataFrame Schema:
[2024-10-15T21:25:31.787+0530] {logging_mixin.py:190} INFO - root
 |-- id: string (nullable = true)
 |-- date: string (nullable = true)
 |-- price: double (nullable = true)
 |-- bedrooms: string (nullable = true)
 |-- bathrooms: string (nullable = true)
 |-- sqft_living: string (nullable = true)
 |-- sqft_lot: string (nullable = true)
 |-- floors: string (nullable = true)
 |-- waterfront: string (nullable = true)
 |-- view: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- grade: string (nullable = true)
 |-- yr_built: string (nullable = true)
 |-- zipcode: string (nullable = true)
 |-- lat: string (nullable = true)
 |-- long: string (nullable = true)
[2024-10-15T21:25:31.793+0530] {logging_mixin.py:190} INFO - First few rows of the DataFrame:
[2024-10-15T21:25:32.748+0530] {logging_mixin.py:190} INFO - +----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|    price|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|     NULL|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
| 629000615|20141022T000000|1495000.0|       4|     3.25|       3070|   10375|     2|        No|No View|  Average|   10|    1962|  98004|47.5862|-122.198|
|4141800215|20141126T000000|1495000.0|       4|     3.75|       3770|    4000|   2.5|        No|No View|Very Good|    9|    1916|  98122|47.6157|-122.287|
|6448000020|20150129T000000|1490000.0|       4|      2.5|       2420|   18480|     1|        No|No View|     Good|    9|    1967|  98004|47.6214|-122.227|
|9522300010|20150331T000000|1490000.0|       3|      3.5|       4560|   14608|     2|        No|Average|  Average|   12|    1990|  98034|47.6995|-122.228|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
only showing top 5 rows
[2024-10-15T21:25:34.035+0530] {logging_mixin.py:190} INFO - Calculating price statistics by zipcode...
[2024-10-15T21:25:36.473+0530] {logging_mixin.py:190} INFO - Price statistics saved to /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode
[2024-10-15T21:25:36.473+0530] {logging_mixin.py:190} INFO - Analyzing house features...
[2024-10-15T21:25:37.852+0530] {logging_mixin.py:190} INFO - House features analysis saved to /home/vboxuser/airflow/dags/analytics/house_features_analysis
[2024-10-15T21:25:37.852+0530] {logging_mixin.py:190} INFO - Analyzing condition and grade distribution...
[2024-10-15T21:25:39.202+0530] {logging_mixin.py:190} INFO - Condition and grade distribution saved to /home/vboxuser/airflow/dags/analytics/condition_distribution
[2024-10-15T21:25:39.206+0530] {logging_mixin.py:190} INFO - Analyzing waterfront properties...
[2024-10-15T21:25:40.680+0530] {logging_mixin.py:190} INFO - Waterfront analysis saved to /home/vboxuser/airflow/dags/analytics/waterfront_analysis
[2024-10-15T21:25:40.680+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv...
[2024-10-15T21:25:40.681+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv
[2024-10-15T21:25:40.691+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/house_features_analysis into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv...
[2024-10-15T21:25:40.691+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv
[2024-10-15T21:25:40.692+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/condition_distribution into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv...
[2024-10-15T21:25:40.692+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv
[2024-10-15T21:25:40.692+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/waterfront_analysis into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv...
[2024-10-15T21:25:40.692+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv
[2024-10-15T21:25:40.692+0530] {logging_mixin.py:190} INFO - Integrating with Google Drive...
[2024-10-15T21:25:40.696+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:25:40.696+0530] {__init__.py:49} INFO - file_cache is only supported with oauth2client<4.0.0
[2024-10-15T21:25:40.698+0530] {logging_mixin.py:190} INFO - Google Drive authentication successful!
[2024-10-15T21:25:40.698+0530] {logging_mixin.py:190} INFO - Deleting old files from Google Drive folder...
[2024-10-15T21:25:47.327+0530] {logging_mixin.py:190} INFO - Deleted file: waterfront_analysis_final.csv with ID: 19bnNJLus6Kw7QLBr39q5lorz99FXXXQf
[2024-10-15T21:25:48.504+0530] {logging_mixin.py:190} INFO - Deleted file: condition_distribution_final.csv with ID: 1bPM1-M9nJ5CFkmIFWgknqaKSRHhA6L9w
[2024-10-15T21:25:49.640+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:25:49.639+0530] {timeout.py:68} ERROR - Process timed out, PID: 5912
[2024-10-15T21:25:49.645+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:25:49.641+0530] {dagbag.py:387} ERROR - Failed to import: /home/vboxuser/airflow/dags/home_schedule_dag.py
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/vboxuser/airflow/dags/home_schedule_dag.py", line 8, in <module>
    from home_analytics import perform_analytics  # Adjust the import based on your file name
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 197, in <module>
    perform_analytics()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 166, in perform_analytics
    delete_old_files()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 161, in delete_old_files
    service.files().delete(fileId=item['id']).execute()
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 923, in execute
    resp, content = _retry_request(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 191, in _retry_request
    resp, content = http.request(uri, method, *args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google_auth_httplib2.py", line 218, in request
    response, content = self.http.request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1725, in request
    (response, content) = self._request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1441, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1393, in _conn_request
    response = conn.getresponse()
  File "/usr/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/usr/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python3.10/http/client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/usr/lib/python3.10/ssl.py", line 1303, in recv_into
    return self.read(nbytes, buffer)
  File "/usr/lib/python3.10/ssl.py", line 1159, in read
    return self._sslobj.read(len, buffer)
  File "/usr/local/lib/python3.10/dist-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/vboxuser/airflow/dags/home_schedule_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#reducing-dag-complexity, PID: 5912
[2024-10-15T21:25:49.646+0530] {processor.py:927} WARNING - No viable dags retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:25:49.665+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 30.040 seconds
[2024-10-15T21:27:20.751+0530] {processor.py:186} INFO - Started process (PID=7133) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:27:20.755+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:27:20.758+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:27:20.758+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:27:26.008+0530] {logging_mixin.py:190} INFO - Reading the CSV file...
[2024-10-15T21:27:31.715+0530] {logging_mixin.py:190} INFO - CSV file loaded successfully!
[2024-10-15T21:27:31.715+0530] {logging_mixin.py:190} INFO - DataFrame Schema:
[2024-10-15T21:27:31.718+0530] {logging_mixin.py:190} INFO - root
 |-- id: string (nullable = true)
 |-- date: string (nullable = true)
 |-- price: double (nullable = true)
 |-- bedrooms: string (nullable = true)
 |-- bathrooms: string (nullable = true)
 |-- sqft_living: string (nullable = true)
 |-- sqft_lot: string (nullable = true)
 |-- floors: string (nullable = true)
 |-- waterfront: string (nullable = true)
 |-- view: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- grade: string (nullable = true)
 |-- yr_built: string (nullable = true)
 |-- zipcode: string (nullable = true)
 |-- lat: string (nullable = true)
 |-- long: string (nullable = true)
[2024-10-15T21:27:31.718+0530] {logging_mixin.py:190} INFO - First few rows of the DataFrame:
[2024-10-15T21:27:32.236+0530] {logging_mixin.py:190} INFO - +----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|    price|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|     NULL|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
| 629000615|20141022T000000|1495000.0|       4|     3.25|       3070|   10375|     2|        No|No View|  Average|   10|    1962|  98004|47.5862|-122.198|
|4141800215|20141126T000000|1495000.0|       4|     3.75|       3770|    4000|   2.5|        No|No View|Very Good|    9|    1916|  98122|47.6157|-122.287|
|6448000020|20150129T000000|1490000.0|       4|      2.5|       2420|   18480|     1|        No|No View|     Good|    9|    1967|  98004|47.6214|-122.227|
|9522300010|20150331T000000|1490000.0|       3|      3.5|       4560|   14608|     2|        No|Average|  Average|   12|    1990|  98034|47.6995|-122.228|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
only showing top 5 rows
[2024-10-15T21:27:33.133+0530] {logging_mixin.py:190} INFO - Calculating price statistics by zipcode...
[2024-10-15T21:27:34.479+0530] {logging_mixin.py:190} INFO - Price statistics saved to /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode
[2024-10-15T21:27:34.479+0530] {logging_mixin.py:190} INFO - Analyzing house features...
[2024-10-15T21:27:35.000+0530] {logging_mixin.py:190} INFO - House features analysis saved to /home/vboxuser/airflow/dags/analytics/house_features_analysis
[2024-10-15T21:27:35.001+0530] {logging_mixin.py:190} INFO - Analyzing condition and grade distribution...
[2024-10-15T21:27:35.522+0530] {logging_mixin.py:190} INFO - Condition and grade distribution saved to /home/vboxuser/airflow/dags/analytics/condition_distribution
[2024-10-15T21:27:35.523+0530] {logging_mixin.py:190} INFO - Analyzing waterfront properties...
[2024-10-15T21:27:36.064+0530] {logging_mixin.py:190} INFO - Waterfront analysis saved to /home/vboxuser/airflow/dags/analytics/waterfront_analysis
[2024-10-15T21:27:36.066+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv...
[2024-10-15T21:27:36.066+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv
[2024-10-15T21:27:36.067+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/house_features_analysis into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv...
[2024-10-15T21:27:36.067+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv
[2024-10-15T21:27:36.067+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/condition_distribution into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv...
[2024-10-15T21:27:36.068+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv
[2024-10-15T21:27:36.068+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/waterfront_analysis into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv...
[2024-10-15T21:27:36.068+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv
[2024-10-15T21:27:36.068+0530] {logging_mixin.py:190} INFO - Integrating with Google Drive...
[2024-10-15T21:27:36.071+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:27:36.071+0530] {__init__.py:49} INFO - file_cache is only supported with oauth2client<4.0.0
[2024-10-15T21:27:36.074+0530] {logging_mixin.py:190} INFO - Google Drive authentication successful!
[2024-10-15T21:27:36.075+0530] {logging_mixin.py:190} INFO - Deleting old files from Google Drive folder...
[2024-10-15T21:27:40.646+0530] {logging_mixin.py:190} INFO - Deleted file: waterfront_analysis_final.csv with ID: 1hxzX-iJARgu_6aR7ENRfHNRwOLN72YW0
[2024-10-15T21:27:41.834+0530] {logging_mixin.py:190} INFO - Deleted file: condition_distribution_final.csv with ID: 1fe3ezKxEdmZm2CL4Psxg4ZVE4o25CdFO
[2024-10-15T21:27:42.957+0530] {logging_mixin.py:190} INFO - Deleted file: house_features_analysis_final.csv with ID: 1VIcwp_dQi2a0PDiYCcWrKpePDcRSQpLO
[2024-10-15T21:27:44.065+0530] {logging_mixin.py:190} INFO - Deleted file: price_stats_by_zipcode_final.csv with ID: 1lDcTrq--4_wYfZPUNEZjLZ7vkCFnJv2G
[2024-10-15T21:27:45.227+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:27:45.227+0530] {http.py:140} WARNING - Encountered 403 Forbidden with reason "insufficientFilePermissions"
[2024-10-15T21:27:45.227+0530] {logging_mixin.py:190} INFO - Error deleting files: <HttpError 403 when requesting https://www.googleapis.com/drive/v3/files/1t1u03ZTia-wSW2Y92aorcd9qEFKTHR5X? returned "The user does not have sufficient permissions for this file.". Details: "[{'message': 'The user does not have sufficient permissions for this file.', 'domain': 'global', 'reason': 'insufficientFilePermissions'}]">
[2024-10-15T21:27:45.228+0530] {logging_mixin.py:190} INFO - Uploading consolidated CSV files to Google Drive...
[2024-10-15T21:27:47.321+0530] {logging_mixin.py:190} INFO - Uploaded price_stats_by_zipcode_final.csv to Google Drive.
[2024-10-15T21:27:49.382+0530] {logging_mixin.py:190} INFO - Uploaded house_features_analysis_final.csv to Google Drive.
[2024-10-15T21:27:50.767+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:27:50.767+0530] {timeout.py:68} ERROR - Process timed out, PID: 7133
[2024-10-15T21:27:50.771+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:27:50.768+0530] {dagbag.py:387} ERROR - Failed to import: /home/vboxuser/airflow/dags/home_schedule_dag.py
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/vboxuser/airflow/dags/home_schedule_dag.py", line 8, in <module>
    from home_analytics import perform_analytics  # Adjust the import based on your file name
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 197, in <module>
    perform_analytics()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 190, in perform_analytics
    ).execute()
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 923, in execute
    resp, content = _retry_request(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 191, in _retry_request
    resp, content = http.request(uri, method, *args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google_auth_httplib2.py", line 218, in request
    response, content = self.http.request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1725, in request
    (response, content) = self._request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1441, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1393, in _conn_request
    response = conn.getresponse()
  File "/usr/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/usr/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python3.10/http/client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/usr/lib/python3.10/ssl.py", line 1303, in recv_into
    return self.read(nbytes, buffer)
  File "/usr/lib/python3.10/ssl.py", line 1159, in read
    return self._sslobj.read(len, buffer)
  File "/usr/local/lib/python3.10/dist-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/vboxuser/airflow/dags/home_schedule_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#reducing-dag-complexity, PID: 7133
[2024-10-15T21:27:50.774+0530] {processor.py:927} WARNING - No viable dags retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:27:50.820+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 30.075 seconds
[2024-10-15T21:28:50.338+0530] {processor.py:186} INFO - Started process (PID=7960) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:28:50.339+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:28:50.342+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:28:50.341+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:28:56.005+0530] {logging_mixin.py:190} INFO - Reading the CSV file...
[2024-10-15T21:29:01.933+0530] {logging_mixin.py:190} INFO - CSV file loaded successfully!
[2024-10-15T21:29:01.934+0530] {logging_mixin.py:190} INFO - DataFrame Schema:
[2024-10-15T21:29:01.936+0530] {logging_mixin.py:190} INFO - root
 |-- id: string (nullable = true)
 |-- date: string (nullable = true)
 |-- price: double (nullable = true)
 |-- bedrooms: string (nullable = true)
 |-- bathrooms: string (nullable = true)
 |-- sqft_living: string (nullable = true)
 |-- sqft_lot: string (nullable = true)
 |-- floors: string (nullable = true)
 |-- waterfront: string (nullable = true)
 |-- view: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- grade: string (nullable = true)
 |-- yr_built: string (nullable = true)
 |-- zipcode: string (nullable = true)
 |-- lat: string (nullable = true)
 |-- long: string (nullable = true)
[2024-10-15T21:29:01.936+0530] {logging_mixin.py:190} INFO - First few rows of the DataFrame:
[2024-10-15T21:29:02.783+0530] {logging_mixin.py:190} INFO - +----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|    price|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|     NULL|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
| 629000615|20141022T000000|1495000.0|       4|     3.25|       3070|   10375|     2|        No|No View|  Average|   10|    1962|  98004|47.5862|-122.198|
|4141800215|20141126T000000|1495000.0|       4|     3.75|       3770|    4000|   2.5|        No|No View|Very Good|    9|    1916|  98122|47.6157|-122.287|
|6448000020|20150129T000000|1490000.0|       4|      2.5|       2420|   18480|     1|        No|No View|     Good|    9|    1967|  98004|47.6214|-122.227|
|9522300010|20150331T000000|1490000.0|       3|      3.5|       4560|   14608|     2|        No|Average|  Average|   12|    1990|  98034|47.6995|-122.228|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
only showing top 5 rows
[2024-10-15T21:29:03.904+0530] {logging_mixin.py:190} INFO - Calculating price statistics by zipcode...
[2024-10-15T21:29:05.970+0530] {logging_mixin.py:190} INFO - Price statistics saved to /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode
[2024-10-15T21:29:05.971+0530] {logging_mixin.py:190} INFO - Analyzing house features...
[2024-10-15T21:29:06.797+0530] {logging_mixin.py:190} INFO - House features analysis saved to /home/vboxuser/airflow/dags/analytics/house_features_analysis
[2024-10-15T21:29:06.797+0530] {logging_mixin.py:190} INFO - Analyzing condition and grade distribution...
[2024-10-15T21:29:07.318+0530] {logging_mixin.py:190} INFO - Condition and grade distribution saved to /home/vboxuser/airflow/dags/analytics/condition_distribution
[2024-10-15T21:29:07.318+0530] {logging_mixin.py:190} INFO - Analyzing waterfront properties...
[2024-10-15T21:29:07.989+0530] {logging_mixin.py:190} INFO - Waterfront analysis saved to /home/vboxuser/airflow/dags/analytics/waterfront_analysis
[2024-10-15T21:29:07.989+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv...
[2024-10-15T21:29:07.990+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv
[2024-10-15T21:29:07.990+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/house_features_analysis into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv...
[2024-10-15T21:29:07.997+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv
[2024-10-15T21:29:07.997+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/condition_distribution into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv...
[2024-10-15T21:29:08.010+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv
[2024-10-15T21:29:08.010+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/waterfront_analysis into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv...
[2024-10-15T21:29:08.011+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv
[2024-10-15T21:29:08.011+0530] {logging_mixin.py:190} INFO - Integrating with Google Drive...
[2024-10-15T21:29:08.014+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:29:08.014+0530] {__init__.py:49} INFO - file_cache is only supported with oauth2client<4.0.0
[2024-10-15T21:29:08.017+0530] {logging_mixin.py:190} INFO - Google Drive authentication successful!
[2024-10-15T21:29:08.018+0530] {logging_mixin.py:190} INFO - Deleting old files from Google Drive folder...
[2024-10-15T21:29:13.373+0530] {logging_mixin.py:190} INFO - Deleted file: condition_distribution_final.csv with ID: 1WILQ7PAh61ETKGVu53mEMJASRjr0y02W
[2024-10-15T21:29:14.539+0530] {logging_mixin.py:190} INFO - Deleted file: house_features_analysis_final.csv with ID: 1MbeKB54dPpyx2VISP4kthn2fl0RP4DUs
[2024-10-15T21:29:15.784+0530] {logging_mixin.py:190} INFO - Deleted file: price_stats_by_zipcode_final.csv with ID: 1aEehQyrmSc2xU3BeoBBFwcYrU63hb614
[2024-10-15T21:29:17.020+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:29:17.019+0530] {http.py:140} WARNING - Encountered 403 Forbidden with reason "insufficientFilePermissions"
[2024-10-15T21:29:17.020+0530] {logging_mixin.py:190} INFO - Error deleting files: <HttpError 403 when requesting https://www.googleapis.com/drive/v3/files/1t1u03ZTia-wSW2Y92aorcd9qEFKTHR5X? returned "The user does not have sufficient permissions for this file.". Details: "[{'message': 'The user does not have sufficient permissions for this file.', 'domain': 'global', 'reason': 'insufficientFilePermissions'}]">
[2024-10-15T21:29:17.020+0530] {logging_mixin.py:190} INFO - Uploading consolidated CSV files to Google Drive...
[2024-10-15T21:29:19.167+0530] {logging_mixin.py:190} INFO - Uploaded price_stats_by_zipcode_final.csv to Google Drive.
[2024-10-15T21:29:20.345+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:29:20.344+0530] {timeout.py:68} ERROR - Process timed out, PID: 7960
[2024-10-15T21:29:20.349+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:29:20.347+0530] {dagbag.py:387} ERROR - Failed to import: /home/vboxuser/airflow/dags/home_schedule_dag.py
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/vboxuser/airflow/dags/home_schedule_dag.py", line 8, in <module>
    from home_analytics import perform_analytics  # Adjust the import based on your file name
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 197, in <module>
    perform_analytics()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 190, in perform_analytics
    ).execute()
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 923, in execute
    resp, content = _retry_request(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 191, in _retry_request
    resp, content = http.request(uri, method, *args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google_auth_httplib2.py", line 218, in request
    response, content = self.http.request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1725, in request
    (response, content) = self._request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1441, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1393, in _conn_request
    response = conn.getresponse()
  File "/usr/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/usr/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python3.10/http/client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/usr/lib/python3.10/ssl.py", line 1303, in recv_into
    return self.read(nbytes, buffer)
  File "/usr/lib/python3.10/ssl.py", line 1159, in read
    return self._sslobj.read(len, buffer)
  File "/usr/local/lib/python3.10/dist-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/vboxuser/airflow/dags/home_schedule_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#reducing-dag-complexity, PID: 7960
[2024-10-15T21:29:20.349+0530] {processor.py:927} WARNING - No viable dags retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:29:20.374+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 30.041 seconds
[2024-10-15T21:29:51.018+0530] {processor.py:186} INFO - Started process (PID=8489) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:29:51.025+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:29:51.027+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:29:51.027+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:29:56.443+0530] {logging_mixin.py:190} INFO - Reading the CSV file...
[2024-10-15T21:30:03.731+0530] {logging_mixin.py:190} INFO - CSV file loaded successfully!
[2024-10-15T21:30:03.732+0530] {logging_mixin.py:190} INFO - DataFrame Schema:
[2024-10-15T21:30:03.737+0530] {logging_mixin.py:190} INFO - root
 |-- id: string (nullable = true)
 |-- date: string (nullable = true)
 |-- price: double (nullable = true)
 |-- bedrooms: string (nullable = true)
 |-- bathrooms: string (nullable = true)
 |-- sqft_living: string (nullable = true)
 |-- sqft_lot: string (nullable = true)
 |-- floors: string (nullable = true)
 |-- waterfront: string (nullable = true)
 |-- view: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- grade: string (nullable = true)
 |-- yr_built: string (nullable = true)
 |-- zipcode: string (nullable = true)
 |-- lat: string (nullable = true)
 |-- long: string (nullable = true)
[2024-10-15T21:30:03.737+0530] {logging_mixin.py:190} INFO - First few rows of the DataFrame:
[2024-10-15T21:30:04.547+0530] {logging_mixin.py:190} INFO - +----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|    price|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|     NULL|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
| 629000615|20141022T000000|1495000.0|       4|     3.25|       3070|   10375|     2|        No|No View|  Average|   10|    1962|  98004|47.5862|-122.198|
|4141800215|20141126T000000|1495000.0|       4|     3.75|       3770|    4000|   2.5|        No|No View|Very Good|    9|    1916|  98122|47.6157|-122.287|
|6448000020|20150129T000000|1490000.0|       4|      2.5|       2420|   18480|     1|        No|No View|     Good|    9|    1967|  98004|47.6214|-122.227|
|9522300010|20150331T000000|1490000.0|       3|      3.5|       4560|   14608|     2|        No|Average|  Average|   12|    1990|  98034|47.6995|-122.228|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
only showing top 5 rows
[2024-10-15T21:30:05.244+0530] {logging_mixin.py:190} INFO - Calculating price statistics by zipcode...
[2024-10-15T21:30:06.486+0530] {logging_mixin.py:190} INFO - Price statistics saved to /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode
[2024-10-15T21:30:06.487+0530] {logging_mixin.py:190} INFO - Analyzing house features...
[2024-10-15T21:30:07.205+0530] {logging_mixin.py:190} INFO - House features analysis saved to /home/vboxuser/airflow/dags/analytics/house_features_analysis
[2024-10-15T21:30:07.205+0530] {logging_mixin.py:190} INFO - Analyzing condition and grade distribution...
[2024-10-15T21:30:08.027+0530] {logging_mixin.py:190} INFO - Condition and grade distribution saved to /home/vboxuser/airflow/dags/analytics/condition_distribution
[2024-10-15T21:30:08.027+0530] {logging_mixin.py:190} INFO - Analyzing waterfront properties...
[2024-10-15T21:30:09.180+0530] {logging_mixin.py:190} INFO - Waterfront analysis saved to /home/vboxuser/airflow/dags/analytics/waterfront_analysis
[2024-10-15T21:30:09.180+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv...
[2024-10-15T21:30:09.181+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv
[2024-10-15T21:30:09.181+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/house_features_analysis into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv...
[2024-10-15T21:30:09.181+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv
[2024-10-15T21:30:09.182+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/condition_distribution into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv...
[2024-10-15T21:30:09.182+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv
[2024-10-15T21:30:09.182+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/waterfront_analysis into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv...
[2024-10-15T21:30:09.183+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv
[2024-10-15T21:30:09.183+0530] {logging_mixin.py:190} INFO - Integrating with Google Drive...
[2024-10-15T21:30:09.195+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:30:09.194+0530] {__init__.py:49} INFO - file_cache is only supported with oauth2client<4.0.0
[2024-10-15T21:30:09.206+0530] {logging_mixin.py:190} INFO - Google Drive authentication successful!
[2024-10-15T21:30:09.206+0530] {logging_mixin.py:190} INFO - Deleting old files from Google Drive folder...
[2024-10-15T21:30:14.054+0530] {logging_mixin.py:190} INFO - Deleted file: house_features_analysis_final.csv with ID: 1ImWXQbdv29koZhxixAk8P_cr21gjZ7FH
[2024-10-15T21:30:15.477+0530] {logging_mixin.py:190} INFO - Deleted file: price_stats_by_zipcode_final.csv with ID: 1pcD9kOFpQRrdi0-N3DSGxt55YjD0Di3G
[2024-10-15T21:30:16.817+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:30:16.817+0530] {http.py:140} WARNING - Encountered 403 Forbidden with reason "insufficientFilePermissions"
[2024-10-15T21:30:16.817+0530] {logging_mixin.py:190} INFO - Error deleting files: <HttpError 403 when requesting https://www.googleapis.com/drive/v3/files/1t1u03ZTia-wSW2Y92aorcd9qEFKTHR5X? returned "The user does not have sufficient permissions for this file.". Details: "[{'message': 'The user does not have sufficient permissions for this file.', 'domain': 'global', 'reason': 'insufficientFilePermissions'}]">
[2024-10-15T21:30:16.818+0530] {logging_mixin.py:190} INFO - Uploading consolidated CSV files to Google Drive...
[2024-10-15T21:30:19.599+0530] {logging_mixin.py:190} INFO - Uploaded price_stats_by_zipcode_final.csv to Google Drive.
[2024-10-15T21:30:21.034+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:30:21.034+0530] {timeout.py:68} ERROR - Process timed out, PID: 8489
[2024-10-15T21:30:21.040+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:30:21.036+0530] {dagbag.py:387} ERROR - Failed to import: /home/vboxuser/airflow/dags/home_schedule_dag.py
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/vboxuser/airflow/dags/home_schedule_dag.py", line 8, in <module>
    from home_analytics import perform_analytics  # Adjust the import based on your file name
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 197, in <module>
    perform_analytics()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 190, in perform_analytics
    ).execute()
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 923, in execute
    resp, content = _retry_request(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 191, in _retry_request
    resp, content = http.request(uri, method, *args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google_auth_httplib2.py", line 218, in request
    response, content = self.http.request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1725, in request
    (response, content) = self._request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1441, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1393, in _conn_request
    response = conn.getresponse()
  File "/usr/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/usr/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python3.10/http/client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/usr/lib/python3.10/ssl.py", line 1303, in recv_into
    return self.read(nbytes, buffer)
  File "/usr/lib/python3.10/ssl.py", line 1159, in read
    return self._sslobj.read(len, buffer)
  File "/usr/local/lib/python3.10/dist-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/vboxuser/airflow/dags/home_schedule_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#reducing-dag-complexity, PID: 8489
[2024-10-15T21:30:21.041+0530] {processor.py:927} WARNING - No viable dags retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:30:21.061+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 30.048 seconds
[2024-10-15T21:31:20.617+0530] {processor.py:186} INFO - Started process (PID=9498) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:31:20.621+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:31:20.623+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:31:20.622+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:31:26.337+0530] {logging_mixin.py:190} INFO - Reading the CSV file...
[2024-10-15T21:31:31.747+0530] {logging_mixin.py:190} INFO - CSV file loaded successfully!
[2024-10-15T21:31:31.747+0530] {logging_mixin.py:190} INFO - DataFrame Schema:
[2024-10-15T21:31:31.750+0530] {logging_mixin.py:190} INFO - root
 |-- id: string (nullable = true)
 |-- date: string (nullable = true)
 |-- price: double (nullable = true)
 |-- bedrooms: string (nullable = true)
 |-- bathrooms: string (nullable = true)
 |-- sqft_living: string (nullable = true)
 |-- sqft_lot: string (nullable = true)
 |-- floors: string (nullable = true)
 |-- waterfront: string (nullable = true)
 |-- view: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- grade: string (nullable = true)
 |-- yr_built: string (nullable = true)
 |-- zipcode: string (nullable = true)
 |-- lat: string (nullable = true)
 |-- long: string (nullable = true)
[2024-10-15T21:31:31.750+0530] {logging_mixin.py:190} INFO - First few rows of the DataFrame:
[2024-10-15T21:31:32.138+0530] {logging_mixin.py:190} INFO - +----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|    price|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|     NULL|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
| 629000615|20141022T000000|1495000.0|       4|     3.25|       3070|   10375|     2|        No|No View|  Average|   10|    1962|  98004|47.5862|-122.198|
|4141800215|20141126T000000|1495000.0|       4|     3.75|       3770|    4000|   2.5|        No|No View|Very Good|    9|    1916|  98122|47.6157|-122.287|
|6448000020|20150129T000000|1490000.0|       4|      2.5|       2420|   18480|     1|        No|No View|     Good|    9|    1967|  98004|47.6214|-122.227|
|9522300010|20150331T000000|1490000.0|       3|      3.5|       4560|   14608|     2|        No|Average|  Average|   12|    1990|  98034|47.6995|-122.228|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
only showing top 5 rows
[2024-10-15T21:31:33.001+0530] {logging_mixin.py:190} INFO - Calculating price statistics by zipcode...
[2024-10-15T21:31:34.314+0530] {logging_mixin.py:190} INFO - Price statistics saved to /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode
[2024-10-15T21:31:34.314+0530] {logging_mixin.py:190} INFO - Analyzing house features...
[2024-10-15T21:31:34.914+0530] {logging_mixin.py:190} INFO - House features analysis saved to /home/vboxuser/airflow/dags/analytics/house_features_analysis
[2024-10-15T21:31:34.915+0530] {logging_mixin.py:190} INFO - Analyzing condition and grade distribution...
[2024-10-15T21:31:35.423+0530] {logging_mixin.py:190} INFO - Condition and grade distribution saved to /home/vboxuser/airflow/dags/analytics/condition_distribution
[2024-10-15T21:31:35.424+0530] {logging_mixin.py:190} INFO - Analyzing waterfront properties...
[2024-10-15T21:31:36.103+0530] {logging_mixin.py:190} INFO - Waterfront analysis saved to /home/vboxuser/airflow/dags/analytics/waterfront_analysis
[2024-10-15T21:31:36.103+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv...
[2024-10-15T21:31:36.104+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv
[2024-10-15T21:31:36.104+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/house_features_analysis into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv...
[2024-10-15T21:31:36.104+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv
[2024-10-15T21:31:36.105+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/condition_distribution into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv...
[2024-10-15T21:31:36.105+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv
[2024-10-15T21:31:36.106+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/waterfront_analysis into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv...
[2024-10-15T21:31:36.106+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv
[2024-10-15T21:31:36.106+0530] {logging_mixin.py:190} INFO - Integrating with Google Drive...
[2024-10-15T21:31:36.109+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:31:36.109+0530] {__init__.py:49} INFO - file_cache is only supported with oauth2client<4.0.0
[2024-10-15T21:31:36.113+0530] {logging_mixin.py:190} INFO - Google Drive authentication successful!
[2024-10-15T21:31:36.113+0530] {logging_mixin.py:190} INFO - Deleting old files from Google Drive folder...
[2024-10-15T21:31:42.282+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:31:42.281+0530] {http.py:140} WARNING - Encountered 403 Forbidden with reason "insufficientFilePermissions"
[2024-10-15T21:31:42.282+0530] {logging_mixin.py:190} INFO - Error deleting files: <HttpError 403 when requesting https://www.googleapis.com/drive/v3/files/1t1u03ZTia-wSW2Y92aorcd9qEFKTHR5X? returned "The user does not have sufficient permissions for this file.". Details: "[{'message': 'The user does not have sufficient permissions for this file.', 'domain': 'global', 'reason': 'insufficientFilePermissions'}]">
[2024-10-15T21:31:42.282+0530] {logging_mixin.py:190} INFO - Uploading consolidated CSV files to Google Drive...
[2024-10-15T21:31:44.112+0530] {logging_mixin.py:190} INFO - Uploaded price_stats_by_zipcode_final.csv to Google Drive.
[2024-10-15T21:31:46.248+0530] {logging_mixin.py:190} INFO - Uploaded house_features_analysis_final.csv to Google Drive.
[2024-10-15T21:31:48.497+0530] {logging_mixin.py:190} INFO - Uploaded condition_distribution_final.csv to Google Drive.
[2024-10-15T21:31:50.635+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:31:50.635+0530] {timeout.py:68} ERROR - Process timed out, PID: 9498
[2024-10-15T21:31:50.640+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:31:50.636+0530] {dagbag.py:387} ERROR - Failed to import: /home/vboxuser/airflow/dags/home_schedule_dag.py
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/vboxuser/airflow/dags/home_schedule_dag.py", line 8, in <module>
    from home_analytics import perform_analytics  # Adjust the import based on your file name
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 197, in <module>
    perform_analytics()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 190, in perform_analytics
    ).execute()
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 923, in execute
    resp, content = _retry_request(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 191, in _retry_request
    resp, content = http.request(uri, method, *args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google_auth_httplib2.py", line 218, in request
    response, content = self.http.request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1725, in request
    (response, content) = self._request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1441, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1393, in _conn_request
    response = conn.getresponse()
  File "/usr/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/usr/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python3.10/http/client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/usr/lib/python3.10/ssl.py", line 1303, in recv_into
    return self.read(nbytes, buffer)
  File "/usr/lib/python3.10/ssl.py", line 1159, in read
    return self._sslobj.read(len, buffer)
  File "/usr/local/lib/python3.10/dist-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/vboxuser/airflow/dags/home_schedule_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#reducing-dag-complexity, PID: 9498
[2024-10-15T21:31:50.640+0530] {processor.py:927} WARNING - No viable dags retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:31:50.657+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 30.046 seconds
[2024-10-15T21:32:21.220+0530] {processor.py:186} INFO - Started process (PID=9929) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:32:21.224+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:32:21.226+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:32:21.226+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:32:31.710+0530] {logging_mixin.py:190} INFO - Reading the CSV file...
[2024-10-15T21:32:37.106+0530] {logging_mixin.py:190} INFO - CSV file loaded successfully!
[2024-10-15T21:32:37.107+0530] {logging_mixin.py:190} INFO - DataFrame Schema:
[2024-10-15T21:32:37.109+0530] {logging_mixin.py:190} INFO - root
 |-- id: string (nullable = true)
 |-- date: string (nullable = true)
 |-- price: double (nullable = true)
 |-- bedrooms: string (nullable = true)
 |-- bathrooms: string (nullable = true)
 |-- sqft_living: string (nullable = true)
 |-- sqft_lot: string (nullable = true)
 |-- floors: string (nullable = true)
 |-- waterfront: string (nullable = true)
 |-- view: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- grade: string (nullable = true)
 |-- yr_built: string (nullable = true)
 |-- zipcode: string (nullable = true)
 |-- lat: string (nullable = true)
 |-- long: string (nullable = true)
[2024-10-15T21:32:37.110+0530] {logging_mixin.py:190} INFO - First few rows of the DataFrame:
[2024-10-15T21:32:37.555+0530] {logging_mixin.py:190} INFO - +----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|    price|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|     NULL|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
| 629000615|20141022T000000|1495000.0|       4|     3.25|       3070|   10375|     2|        No|No View|  Average|   10|    1962|  98004|47.5862|-122.198|
|4141800215|20141126T000000|1495000.0|       4|     3.75|       3770|    4000|   2.5|        No|No View|Very Good|    9|    1916|  98122|47.6157|-122.287|
|6448000020|20150129T000000|1490000.0|       4|      2.5|       2420|   18480|     1|        No|No View|     Good|    9|    1967|  98004|47.6214|-122.227|
|9522300010|20150331T000000|1490000.0|       3|      3.5|       4560|   14608|     2|        No|Average|  Average|   12|    1990|  98034|47.6995|-122.228|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
only showing top 5 rows
[2024-10-15T21:32:38.260+0530] {logging_mixin.py:190} INFO - Calculating price statistics by zipcode...
[2024-10-15T21:32:40.043+0530] {logging_mixin.py:190} INFO - Price statistics saved to /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode
[2024-10-15T21:32:40.045+0530] {logging_mixin.py:190} INFO - Analyzing house features...
[2024-10-15T21:32:41.095+0530] {logging_mixin.py:190} INFO - House features analysis saved to /home/vboxuser/airflow/dags/analytics/house_features_analysis
[2024-10-15T21:32:41.095+0530] {logging_mixin.py:190} INFO - Analyzing condition and grade distribution...
[2024-10-15T21:32:41.933+0530] {logging_mixin.py:190} INFO - Condition and grade distribution saved to /home/vboxuser/airflow/dags/analytics/condition_distribution
[2024-10-15T21:32:41.935+0530] {logging_mixin.py:190} INFO - Analyzing waterfront properties...
[2024-10-15T21:32:42.994+0530] {logging_mixin.py:190} INFO - Waterfront analysis saved to /home/vboxuser/airflow/dags/analytics/waterfront_analysis
[2024-10-15T21:32:42.995+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv...
[2024-10-15T21:32:42.999+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv
[2024-10-15T21:32:43.000+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/house_features_analysis into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv...
[2024-10-15T21:32:43.001+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv
[2024-10-15T21:32:43.001+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/condition_distribution into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv...
[2024-10-15T21:32:43.002+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv
[2024-10-15T21:32:43.002+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/waterfront_analysis into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv...
[2024-10-15T21:32:43.003+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv
[2024-10-15T21:32:43.003+0530] {logging_mixin.py:190} INFO - Integrating with Google Drive...
[2024-10-15T21:32:43.008+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:32:43.007+0530] {__init__.py:49} INFO - file_cache is only supported with oauth2client<4.0.0
[2024-10-15T21:32:43.010+0530] {logging_mixin.py:190} INFO - Google Drive authentication successful!
[2024-10-15T21:32:43.011+0530] {logging_mixin.py:190} INFO - Deleting old files from Google Drive folder...
[2024-10-15T21:32:51.230+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:32:51.230+0530] {timeout.py:68} ERROR - Process timed out, PID: 9929
[2024-10-15T21:32:51.239+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:32:51.231+0530] {dagbag.py:387} ERROR - Failed to import: /home/vboxuser/airflow/dags/home_schedule_dag.py
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/vboxuser/airflow/dags/home_schedule_dag.py", line 8, in <module>
    from home_analytics import perform_analytics  # Adjust the import based on your file name
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 197, in <module>
    perform_analytics()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 166, in perform_analytics
    delete_old_files()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 155, in delete_old_files
    results = service.files().list(q=f"'{folder_id}' in parents", fields="files(id, name)").execute()
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 923, in execute
    resp, content = _retry_request(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 191, in _retry_request
    resp, content = http.request(uri, method, *args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google_auth_httplib2.py", line 209, in request
    self.credentials.before_request(self._request, method, uri, request_headers)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google/auth/credentials.py", line 239, in before_request
    self._blocking_refresh(request)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google/auth/credentials.py", line 202, in _blocking_refresh
    self.refresh(request)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google/oauth2/credentials.py", line 409, in refresh
    ) = reauth.refresh_grant(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google/oauth2/reauth.py", line 333, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google/oauth2/_client.py", line 191, in _token_endpoint_request_no_throw
    response = request(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google_auth_httplib2.py", line 119, in __call__
    response, data = self.http.request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1725, in request
    (response, content) = self._request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1441, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1363, in _conn_request
    conn.connect()
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1153, in connect
    sock.connect((self.host, self.port))
  File "/usr/local/lib/python3.10/dist-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/vboxuser/airflow/dags/home_schedule_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#reducing-dag-complexity, PID: 9929
[2024-10-15T21:32:51.240+0530] {processor.py:927} WARNING - No viable dags retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:32:51.261+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 30.046 seconds
[2024-10-15T21:33:50.837+0530] {processor.py:186} INFO - Started process (PID=10898) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:33:50.840+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:33:50.843+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:33:50.842+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:34:02.113+0530] {logging_mixin.py:190} INFO - Reading the CSV file...
[2024-10-15T21:34:08.084+0530] {logging_mixin.py:190} INFO - CSV file loaded successfully!
[2024-10-15T21:34:08.084+0530] {logging_mixin.py:190} INFO - DataFrame Schema:
[2024-10-15T21:34:08.087+0530] {logging_mixin.py:190} INFO - root
 |-- id: string (nullable = true)
 |-- date: string (nullable = true)
 |-- price: double (nullable = true)
 |-- bedrooms: string (nullable = true)
 |-- bathrooms: string (nullable = true)
 |-- sqft_living: string (nullable = true)
 |-- sqft_lot: string (nullable = true)
 |-- floors: string (nullable = true)
 |-- waterfront: string (nullable = true)
 |-- view: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- grade: string (nullable = true)
 |-- yr_built: string (nullable = true)
 |-- zipcode: string (nullable = true)
 |-- lat: string (nullable = true)
 |-- long: string (nullable = true)
[2024-10-15T21:34:08.088+0530] {logging_mixin.py:190} INFO - First few rows of the DataFrame:
[2024-10-15T21:34:08.673+0530] {logging_mixin.py:190} INFO - +----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|    price|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|     NULL|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
| 629000615|20141022T000000|1495000.0|       4|     3.25|       3070|   10375|     2|        No|No View|  Average|   10|    1962|  98004|47.5862|-122.198|
|4141800215|20141126T000000|1495000.0|       4|     3.75|       3770|    4000|   2.5|        No|No View|Very Good|    9|    1916|  98122|47.6157|-122.287|
|6448000020|20150129T000000|1490000.0|       4|      2.5|       2420|   18480|     1|        No|No View|     Good|    9|    1967|  98004|47.6214|-122.227|
|9522300010|20150331T000000|1490000.0|       3|      3.5|       4560|   14608|     2|        No|Average|  Average|   12|    1990|  98034|47.6995|-122.228|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
only showing top 5 rows
[2024-10-15T21:34:09.251+0530] {logging_mixin.py:190} INFO - Calculating price statistics by zipcode...
[2024-10-15T21:34:10.889+0530] {logging_mixin.py:190} INFO - Price statistics saved to /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode
[2024-10-15T21:34:10.891+0530] {logging_mixin.py:190} INFO - Analyzing house features...
[2024-10-15T21:34:11.926+0530] {logging_mixin.py:190} INFO - House features analysis saved to /home/vboxuser/airflow/dags/analytics/house_features_analysis
[2024-10-15T21:34:11.926+0530] {logging_mixin.py:190} INFO - Analyzing condition and grade distribution...
[2024-10-15T21:34:12.786+0530] {logging_mixin.py:190} INFO - Condition and grade distribution saved to /home/vboxuser/airflow/dags/analytics/condition_distribution
[2024-10-15T21:34:12.787+0530] {logging_mixin.py:190} INFO - Analyzing waterfront properties...
[2024-10-15T21:34:13.521+0530] {logging_mixin.py:190} INFO - Waterfront analysis saved to /home/vboxuser/airflow/dags/analytics/waterfront_analysis
[2024-10-15T21:34:13.521+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv...
[2024-10-15T21:34:13.523+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv
[2024-10-15T21:34:13.523+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/house_features_analysis into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv...
[2024-10-15T21:34:13.523+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv
[2024-10-15T21:34:13.524+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/condition_distribution into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv...
[2024-10-15T21:34:13.524+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv
[2024-10-15T21:34:13.524+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/waterfront_analysis into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv...
[2024-10-15T21:34:13.524+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv
[2024-10-15T21:34:13.524+0530] {logging_mixin.py:190} INFO - Integrating with Google Drive...
[2024-10-15T21:34:13.528+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:34:13.528+0530] {__init__.py:49} INFO - file_cache is only supported with oauth2client<4.0.0
[2024-10-15T21:34:13.544+0530] {logging_mixin.py:190} INFO - Google Drive authentication successful!
[2024-10-15T21:34:13.545+0530] {logging_mixin.py:190} INFO - Deleting old files from Google Drive folder...
[2024-10-15T21:34:39.931+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:34:39.930+0530] {timeout.py:68} ERROR - Process timed out, PID: 10898
[2024-10-15T21:34:39.934+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:34:39.931+0530] {dagbag.py:387} ERROR - Failed to import: /home/vboxuser/airflow/dags/home_schedule_dag.py
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/vboxuser/airflow/dags/home_schedule_dag.py", line 8, in <module>
    from home_analytics import perform_analytics  # Adjust the import based on your file name
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 197, in <module>
    perform_analytics()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 166, in perform_analytics
    delete_old_files()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 155, in delete_old_files
    results = service.files().list(q=f"'{folder_id}' in parents", fields="files(id, name)").execute()
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 923, in execute
    resp, content = _retry_request(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 191, in _retry_request
    resp, content = http.request(uri, method, *args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google_auth_httplib2.py", line 209, in request
    self.credentials.before_request(self._request, method, uri, request_headers)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google/auth/credentials.py", line 239, in before_request
    self._blocking_refresh(request)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google/auth/credentials.py", line 202, in _blocking_refresh
    self.refresh(request)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google/oauth2/credentials.py", line 409, in refresh
    ) = reauth.refresh_grant(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google/oauth2/reauth.py", line 333, in refresh_grant
    response_status_ok, response_data, retryable_error = _client._token_endpoint_request_no_throw(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google/oauth2/_client.py", line 191, in _token_endpoint_request_no_throw
    response = request(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google_auth_httplib2.py", line 119, in __call__
    response, data = self.http.request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1725, in request
    (response, content) = self._request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1441, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1363, in _conn_request
    conn.connect()
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1139, in connect
    address_info = socket.getaddrinfo(host, port, 0, socket.SOCK_STREAM)
  File "/usr/lib/python3.10/socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
  File "/usr/local/lib/python3.10/dist-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/vboxuser/airflow/dags/home_schedule_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#reducing-dag-complexity, PID: 10898
[2024-10-15T21:34:39.934+0530] {processor.py:927} WARNING - No viable dags retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:34:40.013+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 49.182 seconds
[2024-10-15T21:35:14.486+0530] {processor.py:186} INFO - Started process (PID=11450) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:35:14.488+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:35:14.490+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:35:14.490+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:35:19.129+0530] {logging_mixin.py:190} INFO - Reading the CSV file...
[2024-10-15T21:35:25.425+0530] {logging_mixin.py:190} INFO - CSV file loaded successfully!
[2024-10-15T21:35:25.425+0530] {logging_mixin.py:190} INFO - DataFrame Schema:
[2024-10-15T21:35:25.433+0530] {logging_mixin.py:190} INFO - root
 |-- id: string (nullable = true)
 |-- date: string (nullable = true)
 |-- price: double (nullable = true)
 |-- bedrooms: string (nullable = true)
 |-- bathrooms: string (nullable = true)
 |-- sqft_living: string (nullable = true)
 |-- sqft_lot: string (nullable = true)
 |-- floors: string (nullable = true)
 |-- waterfront: string (nullable = true)
 |-- view: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- grade: string (nullable = true)
 |-- yr_built: string (nullable = true)
 |-- zipcode: string (nullable = true)
 |-- lat: string (nullable = true)
 |-- long: string (nullable = true)
[2024-10-15T21:35:25.433+0530] {logging_mixin.py:190} INFO - First few rows of the DataFrame:
[2024-10-15T21:35:26.313+0530] {logging_mixin.py:190} INFO - +----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|    price|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|     NULL|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
| 629000615|20141022T000000|1495000.0|       4|     3.25|       3070|   10375|     2|        No|No View|  Average|   10|    1962|  98004|47.5862|-122.198|
|4141800215|20141126T000000|1495000.0|       4|     3.75|       3770|    4000|   2.5|        No|No View|Very Good|    9|    1916|  98122|47.6157|-122.287|
|6448000020|20150129T000000|1490000.0|       4|      2.5|       2420|   18480|     1|        No|No View|     Good|    9|    1967|  98004|47.6214|-122.227|
|9522300010|20150331T000000|1490000.0|       3|      3.5|       4560|   14608|     2|        No|Average|  Average|   12|    1990|  98034|47.6995|-122.228|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
only showing top 5 rows
[2024-10-15T21:35:26.953+0530] {logging_mixin.py:190} INFO - Calculating price statistics by zipcode...
[2024-10-15T21:35:29.408+0530] {logging_mixin.py:190} INFO - Price statistics saved to /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode
[2024-10-15T21:35:29.408+0530] {logging_mixin.py:190} INFO - Analyzing house features...
[2024-10-15T21:35:30.644+0530] {logging_mixin.py:190} INFO - House features analysis saved to /home/vboxuser/airflow/dags/analytics/house_features_analysis
[2024-10-15T21:35:30.645+0530] {logging_mixin.py:190} INFO - Analyzing condition and grade distribution...
[2024-10-15T21:35:31.940+0530] {logging_mixin.py:190} INFO - Condition and grade distribution saved to /home/vboxuser/airflow/dags/analytics/condition_distribution
[2024-10-15T21:35:31.940+0530] {logging_mixin.py:190} INFO - Analyzing waterfront properties...
[2024-10-15T21:35:33.482+0530] {logging_mixin.py:190} INFO - Waterfront analysis saved to /home/vboxuser/airflow/dags/analytics/waterfront_analysis
[2024-10-15T21:35:33.483+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv...
[2024-10-15T21:35:33.483+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv
[2024-10-15T21:35:33.483+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/house_features_analysis into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv...
[2024-10-15T21:35:33.484+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv
[2024-10-15T21:35:33.484+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/condition_distribution into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv...
[2024-10-15T21:35:33.488+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv
[2024-10-15T21:35:33.488+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/waterfront_analysis into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv...
[2024-10-15T21:35:33.488+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv
[2024-10-15T21:35:33.488+0530] {logging_mixin.py:190} INFO - Integrating with Google Drive...
[2024-10-15T21:35:33.500+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:35:33.500+0530] {__init__.py:49} INFO - file_cache is only supported with oauth2client<4.0.0
[2024-10-15T21:35:33.502+0530] {logging_mixin.py:190} INFO - Google Drive authentication successful!
[2024-10-15T21:35:33.503+0530] {logging_mixin.py:190} INFO - Deleting old files from Google Drive folder...
[2024-10-15T21:35:36.208+0530] {logging_mixin.py:190} INFO - Deleted file: waterfront_analysis_final.csv with ID: 1UYM6zNFaTnGxjyQx7gRW56pPR0vgP1yp
[2024-10-15T21:35:36.857+0530] {logging_mixin.py:190} INFO - Deleted file: condition_distribution_final.csv with ID: 1K4gGiz2NnE3ebPRQtPViCDxRpHbjCB_i
[2024-10-15T21:35:37.749+0530] {logging_mixin.py:190} INFO - Deleted file: house_features_analysis_final.csv with ID: 1yf-E_Dv3nk_PlEY_Fv25ZKLm9gofnx0a
[2024-10-15T21:35:38.446+0530] {logging_mixin.py:190} INFO - Deleted file: price_stats_by_zipcode_final.csv with ID: 19eCi3LLBWwTYEROK7jzhAjta0n9tM_lz
[2024-10-15T21:35:39.263+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:35:39.263+0530] {http.py:140} WARNING - Encountered 403 Forbidden with reason "insufficientFilePermissions"
[2024-10-15T21:35:39.264+0530] {logging_mixin.py:190} INFO - Error deleting files: <HttpError 403 when requesting https://www.googleapis.com/drive/v3/files/1t1u03ZTia-wSW2Y92aorcd9qEFKTHR5X? returned "The user does not have sufficient permissions for this file.". Details: "[{'message': 'The user does not have sufficient permissions for this file.', 'domain': 'global', 'reason': 'insufficientFilePermissions'}]">
[2024-10-15T21:35:39.264+0530] {logging_mixin.py:190} INFO - Uploading consolidated CSV files to Google Drive...
[2024-10-15T21:35:41.377+0530] {logging_mixin.py:190} INFO - Uploaded price_stats_by_zipcode_final.csv to Google Drive.
[2024-10-15T21:35:43.145+0530] {logging_mixin.py:190} INFO - Uploaded house_features_analysis_final.csv to Google Drive.
[2024-10-15T21:35:44.497+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:35:44.496+0530] {timeout.py:68} ERROR - Process timed out, PID: 11450
[2024-10-15T21:35:44.502+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:35:44.497+0530] {dagbag.py:387} ERROR - Failed to import: /home/vboxuser/airflow/dags/home_schedule_dag.py
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/vboxuser/airflow/dags/home_schedule_dag.py", line 8, in <module>
    from home_analytics import perform_analytics  # Adjust the import based on your file name
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 197, in <module>
    perform_analytics()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 190, in perform_analytics
    ).execute()
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 923, in execute
    resp, content = _retry_request(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 191, in _retry_request
    resp, content = http.request(uri, method, *args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google_auth_httplib2.py", line 218, in request
    response, content = self.http.request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1725, in request
    (response, content) = self._request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1441, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1393, in _conn_request
    response = conn.getresponse()
  File "/usr/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/usr/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python3.10/http/client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/usr/lib/python3.10/ssl.py", line 1303, in recv_into
    return self.read(nbytes, buffer)
  File "/usr/lib/python3.10/ssl.py", line 1159, in read
    return self._sslobj.read(len, buffer)
  File "/usr/local/lib/python3.10/dist-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/vboxuser/airflow/dags/home_schedule_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#reducing-dag-complexity, PID: 11450
[2024-10-15T21:35:44.503+0530] {processor.py:927} WARNING - No viable dags retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:35:44.524+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 30.045 seconds
[2024-10-15T21:36:46.746+0530] {processor.py:186} INFO - Started process (PID=12438) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:36:46.748+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:36:46.750+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:36:46.750+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:36:53.082+0530] {logging_mixin.py:190} INFO - Reading the CSV file...
[2024-10-15T21:37:01.062+0530] {logging_mixin.py:190} INFO - CSV file loaded successfully!
[2024-10-15T21:37:01.062+0530] {logging_mixin.py:190} INFO - DataFrame Schema:
[2024-10-15T21:37:01.065+0530] {logging_mixin.py:190} INFO - root
 |-- id: string (nullable = true)
 |-- date: string (nullable = true)
 |-- price: double (nullable = true)
 |-- bedrooms: string (nullable = true)
 |-- bathrooms: string (nullable = true)
 |-- sqft_living: string (nullable = true)
 |-- sqft_lot: string (nullable = true)
 |-- floors: string (nullable = true)
 |-- waterfront: string (nullable = true)
 |-- view: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- grade: string (nullable = true)
 |-- yr_built: string (nullable = true)
 |-- zipcode: string (nullable = true)
 |-- lat: string (nullable = true)
 |-- long: string (nullable = true)
[2024-10-15T21:37:01.065+0530] {logging_mixin.py:190} INFO - First few rows of the DataFrame:
[2024-10-15T21:37:01.771+0530] {logging_mixin.py:190} INFO - +----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|    price|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|     NULL|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
| 629000615|20141022T000000|1495000.0|       4|     3.25|       3070|   10375|     2|        No|No View|  Average|   10|    1962|  98004|47.5862|-122.198|
|4141800215|20141126T000000|1495000.0|       4|     3.75|       3770|    4000|   2.5|        No|No View|Very Good|    9|    1916|  98122|47.6157|-122.287|
|6448000020|20150129T000000|1490000.0|       4|      2.5|       2420|   18480|     1|        No|No View|     Good|    9|    1967|  98004|47.6214|-122.227|
|9522300010|20150331T000000|1490000.0|       3|      3.5|       4560|   14608|     2|        No|Average|  Average|   12|    1990|  98034|47.6995|-122.228|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
only showing top 5 rows
[2024-10-15T21:37:02.618+0530] {logging_mixin.py:190} INFO - Calculating price statistics by zipcode...
[2024-10-15T21:37:04.317+0530] {logging_mixin.py:190} INFO - Price statistics saved to /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode
[2024-10-15T21:37:04.317+0530] {logging_mixin.py:190} INFO - Analyzing house features...
[2024-10-15T21:37:05.387+0530] {logging_mixin.py:190} INFO - House features analysis saved to /home/vboxuser/airflow/dags/analytics/house_features_analysis
[2024-10-15T21:37:05.388+0530] {logging_mixin.py:190} INFO - Analyzing condition and grade distribution...
[2024-10-15T21:37:06.127+0530] {logging_mixin.py:190} INFO - Condition and grade distribution saved to /home/vboxuser/airflow/dags/analytics/condition_distribution
[2024-10-15T21:37:06.127+0530] {logging_mixin.py:190} INFO - Analyzing waterfront properties...
[2024-10-15T21:37:07.138+0530] {logging_mixin.py:190} INFO - Waterfront analysis saved to /home/vboxuser/airflow/dags/analytics/waterfront_analysis
[2024-10-15T21:37:07.139+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv...
[2024-10-15T21:37:07.139+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv
[2024-10-15T21:37:07.139+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/house_features_analysis into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv...
[2024-10-15T21:37:07.141+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv
[2024-10-15T21:37:07.141+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/condition_distribution into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv...
[2024-10-15T21:37:07.141+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv
[2024-10-15T21:37:07.142+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/waterfront_analysis into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv...
[2024-10-15T21:37:07.142+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv
[2024-10-15T21:37:07.144+0530] {logging_mixin.py:190} INFO - Integrating with Google Drive...
[2024-10-15T21:37:07.147+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:37:07.147+0530] {__init__.py:49} INFO - file_cache is only supported with oauth2client<4.0.0
[2024-10-15T21:37:07.149+0530] {logging_mixin.py:190} INFO - Google Drive authentication successful!
[2024-10-15T21:37:07.150+0530] {logging_mixin.py:190} INFO - Deleting old files from Google Drive folder...
[2024-10-15T21:37:10.353+0530] {logging_mixin.py:190} INFO - Deleted file: price_stats_by_zipcode_final.csv with ID: 1QGbLoV_W_YVH1B9yTYXyLEd8mktnKL09
[2024-10-15T21:37:11.339+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:37:11.339+0530] {http.py:140} WARNING - Encountered 403 Forbidden with reason "insufficientFilePermissions"
[2024-10-15T21:37:11.340+0530] {logging_mixin.py:190} INFO - Error deleting files: <HttpError 403 when requesting https://www.googleapis.com/drive/v3/files/1t1u03ZTia-wSW2Y92aorcd9qEFKTHR5X? returned "The user does not have sufficient permissions for this file.". Details: "[{'message': 'The user does not have sufficient permissions for this file.', 'domain': 'global', 'reason': 'insufficientFilePermissions'}]">
[2024-10-15T21:37:11.340+0530] {logging_mixin.py:190} INFO - Uploading consolidated CSV files to Google Drive...
[2024-10-15T21:37:13.062+0530] {logging_mixin.py:190} INFO - Uploaded price_stats_by_zipcode_final.csv to Google Drive.
[2024-10-15T21:37:14.820+0530] {logging_mixin.py:190} INFO - Uploaded house_features_analysis_final.csv to Google Drive.
[2024-10-15T21:37:16.525+0530] {logging_mixin.py:190} INFO - Uploaded condition_distribution_final.csv to Google Drive.
[2024-10-15T21:37:16.758+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:37:16.757+0530] {timeout.py:68} ERROR - Process timed out, PID: 12438
[2024-10-15T21:37:16.764+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:37:16.760+0530] {dagbag.py:387} ERROR - Failed to import: /home/vboxuser/airflow/dags/home_schedule_dag.py
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/vboxuser/airflow/dags/home_schedule_dag.py", line 8, in <module>
    from home_analytics import perform_analytics  # Adjust the import based on your file name
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 197, in <module>
    perform_analytics()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 190, in perform_analytics
    ).execute()
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 923, in execute
    resp, content = _retry_request(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 191, in _retry_request
    resp, content = http.request(uri, method, *args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google_auth_httplib2.py", line 218, in request
    response, content = self.http.request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1725, in request
    (response, content) = self._request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1441, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1393, in _conn_request
    response = conn.getresponse()
  File "/usr/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/usr/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python3.10/http/client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/usr/lib/python3.10/ssl.py", line 1303, in recv_into
    return self.read(nbytes, buffer)
  File "/usr/lib/python3.10/ssl.py", line 1159, in read
    return self._sslobj.read(len, buffer)
  File "/usr/local/lib/python3.10/dist-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/vboxuser/airflow/dags/home_schedule_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#reducing-dag-complexity, PID: 12438
[2024-10-15T21:37:16.765+0530] {processor.py:927} WARNING - No viable dags retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:37:16.787+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 30.049 seconds
[2024-10-15T21:38:18.367+0530] {processor.py:186} INFO - Started process (PID=13452) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:38:18.370+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:38:18.373+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:38:18.372+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:38:23.427+0530] {logging_mixin.py:190} INFO - Reading the CSV file...
[2024-10-15T21:38:29.597+0530] {logging_mixin.py:190} INFO - CSV file loaded successfully!
[2024-10-15T21:38:29.597+0530] {logging_mixin.py:190} INFO - DataFrame Schema:
[2024-10-15T21:38:29.600+0530] {logging_mixin.py:190} INFO - root
 |-- id: string (nullable = true)
 |-- date: string (nullable = true)
 |-- price: double (nullable = true)
 |-- bedrooms: string (nullable = true)
 |-- bathrooms: string (nullable = true)
 |-- sqft_living: string (nullable = true)
 |-- sqft_lot: string (nullable = true)
 |-- floors: string (nullable = true)
 |-- waterfront: string (nullable = true)
 |-- view: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- grade: string (nullable = true)
 |-- yr_built: string (nullable = true)
 |-- zipcode: string (nullable = true)
 |-- lat: string (nullable = true)
 |-- long: string (nullable = true)
[2024-10-15T21:38:29.601+0530] {logging_mixin.py:190} INFO - First few rows of the DataFrame:
[2024-10-15T21:38:30.082+0530] {logging_mixin.py:190} INFO - +----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|    price|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|     NULL|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
| 629000615|20141022T000000|1495000.0|       4|     3.25|       3070|   10375|     2|        No|No View|  Average|   10|    1962|  98004|47.5862|-122.198|
|4141800215|20141126T000000|1495000.0|       4|     3.75|       3770|    4000|   2.5|        No|No View|Very Good|    9|    1916|  98122|47.6157|-122.287|
|6448000020|20150129T000000|1490000.0|       4|      2.5|       2420|   18480|     1|        No|No View|     Good|    9|    1967|  98004|47.6214|-122.227|
|9522300010|20150331T000000|1490000.0|       3|      3.5|       4560|   14608|     2|        No|Average|  Average|   12|    1990|  98034|47.6995|-122.228|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
only showing top 5 rows
[2024-10-15T21:38:30.550+0530] {logging_mixin.py:190} INFO - Calculating price statistics by zipcode...
[2024-10-15T21:38:31.682+0530] {logging_mixin.py:190} INFO - Price statistics saved to /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode
[2024-10-15T21:38:31.682+0530] {logging_mixin.py:190} INFO - Analyzing house features...
[2024-10-15T21:38:32.441+0530] {logging_mixin.py:190} INFO - House features analysis saved to /home/vboxuser/airflow/dags/analytics/house_features_analysis
[2024-10-15T21:38:32.442+0530] {logging_mixin.py:190} INFO - Analyzing condition and grade distribution...
[2024-10-15T21:38:33.225+0530] {logging_mixin.py:190} INFO - Condition and grade distribution saved to /home/vboxuser/airflow/dags/analytics/condition_distribution
[2024-10-15T21:38:33.225+0530] {logging_mixin.py:190} INFO - Analyzing waterfront properties...
[2024-10-15T21:38:34.221+0530] {logging_mixin.py:190} INFO - Waterfront analysis saved to /home/vboxuser/airflow/dags/analytics/waterfront_analysis
[2024-10-15T21:38:34.222+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv...
[2024-10-15T21:38:34.225+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv
[2024-10-15T21:38:34.226+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/house_features_analysis into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv...
[2024-10-15T21:38:34.226+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv
[2024-10-15T21:38:34.226+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/condition_distribution into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv...
[2024-10-15T21:38:34.227+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv
[2024-10-15T21:38:34.227+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/waterfront_analysis into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv...
[2024-10-15T21:38:34.228+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv
[2024-10-15T21:38:34.228+0530] {logging_mixin.py:190} INFO - Integrating with Google Drive...
[2024-10-15T21:38:34.231+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:38:34.231+0530] {__init__.py:49} INFO - file_cache is only supported with oauth2client<4.0.0
[2024-10-15T21:38:34.234+0530] {logging_mixin.py:190} INFO - Google Drive authentication successful!
[2024-10-15T21:38:34.235+0530] {logging_mixin.py:190} INFO - Deleting old files from Google Drive folder...
[2024-10-15T21:38:40.508+0530] {logging_mixin.py:190} INFO - Deleted file: house_features_analysis_final.csv with ID: 1p5l61UNWjoxceLi8Q4ADSxks1OxvYPPo
[2024-10-15T21:38:42.021+0530] {logging_mixin.py:190} INFO - Deleted file: price_stats_by_zipcode_final.csv with ID: 1uXEd71G6_qGbK-Duk0DlDkksTo_1vq0U
[2024-10-15T21:38:42.866+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:38:42.866+0530] {http.py:140} WARNING - Encountered 403 Forbidden with reason "insufficientFilePermissions"
[2024-10-15T21:38:42.866+0530] {logging_mixin.py:190} INFO - Error deleting files: <HttpError 403 when requesting https://www.googleapis.com/drive/v3/files/1t1u03ZTia-wSW2Y92aorcd9qEFKTHR5X? returned "The user does not have sufficient permissions for this file.". Details: "[{'message': 'The user does not have sufficient permissions for this file.', 'domain': 'global', 'reason': 'insufficientFilePermissions'}]">
[2024-10-15T21:38:42.866+0530] {logging_mixin.py:190} INFO - Uploading consolidated CSV files to Google Drive...
[2024-10-15T21:38:45.270+0530] {logging_mixin.py:190} INFO - Uploaded price_stats_by_zipcode_final.csv to Google Drive.
[2024-10-15T21:38:46.859+0530] {logging_mixin.py:190} INFO - Uploaded house_features_analysis_final.csv to Google Drive.
[2024-10-15T21:38:48.378+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:38:48.378+0530] {timeout.py:68} ERROR - Process timed out, PID: 13452
[2024-10-15T21:38:48.381+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:38:48.379+0530] {dagbag.py:387} ERROR - Failed to import: /home/vboxuser/airflow/dags/home_schedule_dag.py
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/vboxuser/airflow/dags/home_schedule_dag.py", line 8, in <module>
    from home_analytics import perform_analytics  # Adjust the import based on your file name
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 197, in <module>
    perform_analytics()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 190, in perform_analytics
    ).execute()
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 923, in execute
    resp, content = _retry_request(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 191, in _retry_request
    resp, content = http.request(uri, method, *args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google_auth_httplib2.py", line 218, in request
    response, content = self.http.request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1725, in request
    (response, content) = self._request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1441, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1393, in _conn_request
    response = conn.getresponse()
  File "/usr/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/usr/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python3.10/http/client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/usr/lib/python3.10/ssl.py", line 1303, in recv_into
    return self.read(nbytes, buffer)
  File "/usr/lib/python3.10/ssl.py", line 1159, in read
    return self._sslobj.read(len, buffer)
  File "/usr/local/lib/python3.10/dist-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/vboxuser/airflow/dags/home_schedule_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#reducing-dag-complexity, PID: 13452
[2024-10-15T21:38:48.381+0530] {processor.py:927} WARNING - No viable dags retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:38:48.403+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 30.049 seconds
[2024-10-15T21:39:31.365+0530] {processor.py:186} INFO - Started process (PID=14279) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:39:31.366+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:39:31.370+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:39:31.369+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:39:35.042+0530] {logging_mixin.py:190} INFO - Reading the CSV file...
[2024-10-15T21:39:41.108+0530] {logging_mixin.py:190} INFO - CSV file loaded successfully!
[2024-10-15T21:39:41.108+0530] {logging_mixin.py:190} INFO - DataFrame Schema:
[2024-10-15T21:39:41.111+0530] {logging_mixin.py:190} INFO - root
 |-- id: string (nullable = true)
 |-- date: string (nullable = true)
 |-- price: double (nullable = true)
 |-- bedrooms: string (nullable = true)
 |-- bathrooms: string (nullable = true)
 |-- sqft_living: string (nullable = true)
 |-- sqft_lot: string (nullable = true)
 |-- floors: string (nullable = true)
 |-- waterfront: string (nullable = true)
 |-- view: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- grade: string (nullable = true)
 |-- yr_built: string (nullable = true)
 |-- zipcode: string (nullable = true)
 |-- lat: string (nullable = true)
 |-- long: string (nullable = true)
[2024-10-15T21:39:41.112+0530] {logging_mixin.py:190} INFO - First few rows of the DataFrame:
[2024-10-15T21:39:41.657+0530] {logging_mixin.py:190} INFO - +----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|    price|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|     NULL|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
| 629000615|20141022T000000|1495000.0|       4|     3.25|       3070|   10375|     2|        No|No View|  Average|   10|    1962|  98004|47.5862|-122.198|
|4141800215|20141126T000000|1495000.0|       4|     3.75|       3770|    4000|   2.5|        No|No View|Very Good|    9|    1916|  98122|47.6157|-122.287|
|6448000020|20150129T000000|1490000.0|       4|      2.5|       2420|   18480|     1|        No|No View|     Good|    9|    1967|  98004|47.6214|-122.227|
|9522300010|20150331T000000|1490000.0|       3|      3.5|       4560|   14608|     2|        No|Average|  Average|   12|    1990|  98034|47.6995|-122.228|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
only showing top 5 rows
[2024-10-15T21:39:42.462+0530] {logging_mixin.py:190} INFO - Calculating price statistics by zipcode...
[2024-10-15T21:39:44.003+0530] {logging_mixin.py:190} INFO - Price statistics saved to /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode
[2024-10-15T21:39:44.003+0530] {logging_mixin.py:190} INFO - Analyzing house features...
[2024-10-15T21:39:44.935+0530] {logging_mixin.py:190} INFO - House features analysis saved to /home/vboxuser/airflow/dags/analytics/house_features_analysis
[2024-10-15T21:39:44.939+0530] {logging_mixin.py:190} INFO - Analyzing condition and grade distribution...
[2024-10-15T21:39:45.850+0530] {logging_mixin.py:190} INFO - Condition and grade distribution saved to /home/vboxuser/airflow/dags/analytics/condition_distribution
[2024-10-15T21:39:45.850+0530] {logging_mixin.py:190} INFO - Analyzing waterfront properties...
[2024-10-15T21:39:46.641+0530] {logging_mixin.py:190} INFO - Waterfront analysis saved to /home/vboxuser/airflow/dags/analytics/waterfront_analysis
[2024-10-15T21:39:46.641+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv...
[2024-10-15T21:39:46.642+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv
[2024-10-15T21:39:46.642+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/house_features_analysis into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv...
[2024-10-15T21:39:46.642+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv
[2024-10-15T21:39:46.643+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/condition_distribution into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv...
[2024-10-15T21:39:46.643+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv
[2024-10-15T21:39:46.643+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/waterfront_analysis into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv...
[2024-10-15T21:39:46.647+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv
[2024-10-15T21:39:46.648+0530] {logging_mixin.py:190} INFO - Integrating with Google Drive...
[2024-10-15T21:39:46.651+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:39:46.651+0530] {__init__.py:49} INFO - file_cache is only supported with oauth2client<4.0.0
[2024-10-15T21:39:46.653+0530] {logging_mixin.py:190} INFO - Google Drive authentication successful!
[2024-10-15T21:39:46.654+0530] {logging_mixin.py:190} INFO - Deleting old files from Google Drive folder...
[2024-10-15T21:39:51.938+0530] {logging_mixin.py:190} INFO - Deleted file: condition_distribution_final.csv with ID: 1uEELWloF5ewGK5CSIVokEnMvsmVB7KSB
[2024-10-15T21:39:53.167+0530] {logging_mixin.py:190} INFO - Deleted file: house_features_analysis_final.csv with ID: 14N63qToZy6wN1fRAl_osHKLMhP1M0o3X
[2024-10-15T21:39:54.395+0530] {logging_mixin.py:190} INFO - Deleted file: price_stats_by_zipcode_final.csv with ID: 1uiPijYCwN6U3_E4YXj137fNf8NEhUund
[2024-10-15T21:39:55.846+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:39:55.845+0530] {http.py:140} WARNING - Encountered 403 Forbidden with reason "insufficientFilePermissions"
[2024-10-15T21:39:55.846+0530] {logging_mixin.py:190} INFO - Error deleting files: <HttpError 403 when requesting https://www.googleapis.com/drive/v3/files/1t1u03ZTia-wSW2Y92aorcd9qEFKTHR5X? returned "The user does not have sufficient permissions for this file.". Details: "[{'message': 'The user does not have sufficient permissions for this file.', 'domain': 'global', 'reason': 'insufficientFilePermissions'}]">
[2024-10-15T21:39:55.846+0530] {logging_mixin.py:190} INFO - Uploading consolidated CSV files to Google Drive...
[2024-10-15T21:39:57.984+0530] {logging_mixin.py:190} INFO - Uploaded price_stats_by_zipcode_final.csv to Google Drive.
[2024-10-15T21:40:00.441+0530] {logging_mixin.py:190} INFO - Uploaded house_features_analysis_final.csv to Google Drive.
[2024-10-15T21:40:01.375+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:40:01.374+0530] {timeout.py:68} ERROR - Process timed out, PID: 14279
[2024-10-15T21:40:01.378+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:40:01.375+0530] {dagbag.py:387} ERROR - Failed to import: /home/vboxuser/airflow/dags/home_schedule_dag.py
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/vboxuser/airflow/dags/home_schedule_dag.py", line 8, in <module>
    from home_analytics import perform_analytics  # Adjust the import based on your file name
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 197, in <module>
    perform_analytics()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 190, in perform_analytics
    ).execute()
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 923, in execute
    resp, content = _retry_request(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 191, in _retry_request
    resp, content = http.request(uri, method, *args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google_auth_httplib2.py", line 218, in request
    response, content = self.http.request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1725, in request
    (response, content) = self._request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1441, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1393, in _conn_request
    response = conn.getresponse()
  File "/usr/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/usr/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python3.10/http/client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/usr/lib/python3.10/ssl.py", line 1303, in recv_into
    return self.read(nbytes, buffer)
  File "/usr/lib/python3.10/ssl.py", line 1159, in read
    return self._sslobj.read(len, buffer)
  File "/usr/local/lib/python3.10/dist-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/vboxuser/airflow/dags/home_schedule_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#reducing-dag-complexity, PID: 14279
[2024-10-15T21:40:01.379+0530] {processor.py:927} WARNING - No viable dags retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:40:01.398+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 30.040 seconds
[2024-10-15T21:41:34.617+0530] {processor.py:186} INFO - Started process (PID=15309) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:41:34.620+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:41:34.622+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:41:34.622+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:41:39.839+0530] {logging_mixin.py:190} INFO - Reading the CSV file...
[2024-10-15T21:41:48.816+0530] {logging_mixin.py:190} INFO - CSV file loaded successfully!
[2024-10-15T21:41:48.816+0530] {logging_mixin.py:190} INFO - DataFrame Schema:
[2024-10-15T21:41:48.826+0530] {logging_mixin.py:190} INFO - root
 |-- id: string (nullable = true)
 |-- date: string (nullable = true)
 |-- price: double (nullable = true)
 |-- bedrooms: string (nullable = true)
 |-- bathrooms: string (nullable = true)
 |-- sqft_living: string (nullable = true)
 |-- sqft_lot: string (nullable = true)
 |-- floors: string (nullable = true)
 |-- waterfront: string (nullable = true)
 |-- view: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- grade: string (nullable = true)
 |-- yr_built: string (nullable = true)
 |-- zipcode: string (nullable = true)
 |-- lat: string (nullable = true)
 |-- long: string (nullable = true)
[2024-10-15T21:41:48.826+0530] {logging_mixin.py:190} INFO - First few rows of the DataFrame:
[2024-10-15T21:41:49.655+0530] {logging_mixin.py:190} INFO - +----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|    price|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|     NULL|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
| 629000615|20141022T000000|1495000.0|       4|     3.25|       3070|   10375|     2|        No|No View|  Average|   10|    1962|  98004|47.5862|-122.198|
|4141800215|20141126T000000|1495000.0|       4|     3.75|       3770|    4000|   2.5|        No|No View|Very Good|    9|    1916|  98122|47.6157|-122.287|
|6448000020|20150129T000000|1490000.0|       4|      2.5|       2420|   18480|     1|        No|No View|     Good|    9|    1967|  98004|47.6214|-122.227|
|9522300010|20150331T000000|1490000.0|       3|      3.5|       4560|   14608|     2|        No|Average|  Average|   12|    1990|  98034|47.6995|-122.228|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
only showing top 5 rows
[2024-10-15T21:41:50.415+0530] {logging_mixin.py:190} INFO - Calculating price statistics by zipcode...
[2024-10-15T21:41:52.420+0530] {logging_mixin.py:190} INFO - Price statistics saved to /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode
[2024-10-15T21:41:52.421+0530] {logging_mixin.py:190} INFO - Analyzing house features...
[2024-10-15T21:41:53.103+0530] {logging_mixin.py:190} INFO - House features analysis saved to /home/vboxuser/airflow/dags/analytics/house_features_analysis
[2024-10-15T21:41:53.104+0530] {logging_mixin.py:190} INFO - Analyzing condition and grade distribution...
[2024-10-15T21:41:54.039+0530] {logging_mixin.py:190} INFO - Condition and grade distribution saved to /home/vboxuser/airflow/dags/analytics/condition_distribution
[2024-10-15T21:41:54.040+0530] {logging_mixin.py:190} INFO - Analyzing waterfront properties...
[2024-10-15T21:41:55.178+0530] {logging_mixin.py:190} INFO - Waterfront analysis saved to /home/vboxuser/airflow/dags/analytics/waterfront_analysis
[2024-10-15T21:41:55.179+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv...
[2024-10-15T21:41:55.181+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv
[2024-10-15T21:41:55.184+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/house_features_analysis into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv...
[2024-10-15T21:41:55.185+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv
[2024-10-15T21:41:55.186+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/condition_distribution into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv...
[2024-10-15T21:41:55.188+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv
[2024-10-15T21:41:55.189+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/waterfront_analysis into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv...
[2024-10-15T21:41:55.189+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv
[2024-10-15T21:41:55.190+0530] {logging_mixin.py:190} INFO - Integrating with Google Drive...
[2024-10-15T21:41:55.193+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:41:55.192+0530] {__init__.py:49} INFO - file_cache is only supported with oauth2client<4.0.0
[2024-10-15T21:41:55.196+0530] {logging_mixin.py:190} INFO - Google Drive authentication successful!
[2024-10-15T21:41:55.197+0530] {logging_mixin.py:190} INFO - Deleting old files from Google Drive folder...
[2024-10-15T21:42:01.731+0530] {logging_mixin.py:190} INFO - Deleted file: waterfront_analysis_final.csv with ID: 1WPVo1zntulMQ3VIOtrZbsan0zO4uDMqf
[2024-10-15T21:42:02.850+0530] {logging_mixin.py:190} INFO - Deleted file: condition_distribution_final.csv with ID: 1nUmU-GoMnqaM6ocQnDM870-wA_tRWg2L
[2024-10-15T21:42:04.076+0530] {logging_mixin.py:190} INFO - Deleted file: house_features_analysis_final.csv with ID: 1ELY6VIenZfPN3hVd2IWAjBASo5Vjb-nh
[2024-10-15T21:42:04.643+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:42:04.642+0530] {timeout.py:68} ERROR - Process timed out, PID: 15309
[2024-10-15T21:42:04.648+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:42:04.644+0530] {dagbag.py:387} ERROR - Failed to import: /home/vboxuser/airflow/dags/home_schedule_dag.py
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/vboxuser/airflow/dags/home_schedule_dag.py", line 8, in <module>
    from home_analytics import perform_analytics  # Adjust the import based on your file name
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 197, in <module>
    perform_analytics()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 166, in perform_analytics
    delete_old_files()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 161, in delete_old_files
    service.files().delete(fileId=item['id']).execute()
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 923, in execute
    resp, content = _retry_request(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 191, in _retry_request
    resp, content = http.request(uri, method, *args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google_auth_httplib2.py", line 218, in request
    response, content = self.http.request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1725, in request
    (response, content) = self._request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1441, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1393, in _conn_request
    response = conn.getresponse()
  File "/usr/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/usr/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python3.10/http/client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/usr/lib/python3.10/ssl.py", line 1303, in recv_into
    return self.read(nbytes, buffer)
  File "/usr/lib/python3.10/ssl.py", line 1159, in read
    return self._sslobj.read(len, buffer)
  File "/usr/local/lib/python3.10/dist-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/vboxuser/airflow/dags/home_schedule_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#reducing-dag-complexity, PID: 15309
[2024-10-15T21:42:04.649+0530] {processor.py:927} WARNING - No viable dags retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:42:04.667+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 30.055 seconds
[2024-10-15T21:43:05.608+0530] {processor.py:186} INFO - Started process (PID=16168) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:43:05.612+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:43:05.613+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:43:05.613+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:43:11.665+0530] {logging_mixin.py:190} INFO - Reading the CSV file...
[2024-10-15T21:43:19.160+0530] {logging_mixin.py:190} INFO - CSV file loaded successfully!
[2024-10-15T21:43:19.160+0530] {logging_mixin.py:190} INFO - DataFrame Schema:
[2024-10-15T21:43:19.171+0530] {logging_mixin.py:190} INFO - root
 |-- id: string (nullable = true)
 |-- date: string (nullable = true)
 |-- price: double (nullable = true)
 |-- bedrooms: string (nullable = true)
 |-- bathrooms: string (nullable = true)
 |-- sqft_living: string (nullable = true)
 |-- sqft_lot: string (nullable = true)
 |-- floors: string (nullable = true)
 |-- waterfront: string (nullable = true)
 |-- view: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- grade: string (nullable = true)
 |-- yr_built: string (nullable = true)
 |-- zipcode: string (nullable = true)
 |-- lat: string (nullable = true)
 |-- long: string (nullable = true)
[2024-10-15T21:43:19.176+0530] {logging_mixin.py:190} INFO - First few rows of the DataFrame:
[2024-10-15T21:43:19.699+0530] {logging_mixin.py:190} INFO - +----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|    price|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|     NULL|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
| 629000615|20141022T000000|1495000.0|       4|     3.25|       3070|   10375|     2|        No|No View|  Average|   10|    1962|  98004|47.5862|-122.198|
|4141800215|20141126T000000|1495000.0|       4|     3.75|       3770|    4000|   2.5|        No|No View|Very Good|    9|    1916|  98122|47.6157|-122.287|
|6448000020|20150129T000000|1490000.0|       4|      2.5|       2420|   18480|     1|        No|No View|     Good|    9|    1967|  98004|47.6214|-122.227|
|9522300010|20150331T000000|1490000.0|       3|      3.5|       4560|   14608|     2|        No|Average|  Average|   12|    1990|  98034|47.6995|-122.228|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
only showing top 5 rows
[2024-10-15T21:43:20.405+0530] {logging_mixin.py:190} INFO - Calculating price statistics by zipcode...
[2024-10-15T21:43:22.237+0530] {logging_mixin.py:190} INFO - Price statistics saved to /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode
[2024-10-15T21:43:22.237+0530] {logging_mixin.py:190} INFO - Analyzing house features...
[2024-10-15T21:43:23.141+0530] {logging_mixin.py:190} INFO - House features analysis saved to /home/vboxuser/airflow/dags/analytics/house_features_analysis
[2024-10-15T21:43:23.142+0530] {logging_mixin.py:190} INFO - Analyzing condition and grade distribution...
[2024-10-15T21:43:23.653+0530] {logging_mixin.py:190} INFO - Condition and grade distribution saved to /home/vboxuser/airflow/dags/analytics/condition_distribution
[2024-10-15T21:43:23.653+0530] {logging_mixin.py:190} INFO - Analyzing waterfront properties...
[2024-10-15T21:43:24.434+0530] {logging_mixin.py:190} INFO - Waterfront analysis saved to /home/vboxuser/airflow/dags/analytics/waterfront_analysis
[2024-10-15T21:43:24.435+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv...
[2024-10-15T21:43:24.435+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv
[2024-10-15T21:43:24.436+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/house_features_analysis into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv...
[2024-10-15T21:43:24.436+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv
[2024-10-15T21:43:24.436+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/condition_distribution into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv...
[2024-10-15T21:43:24.437+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv
[2024-10-15T21:43:24.437+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/waterfront_analysis into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv...
[2024-10-15T21:43:24.437+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv
[2024-10-15T21:43:24.437+0530] {logging_mixin.py:190} INFO - Integrating with Google Drive...
[2024-10-15T21:43:24.441+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:43:24.440+0530] {__init__.py:49} INFO - file_cache is only supported with oauth2client<4.0.0
[2024-10-15T21:43:24.444+0530] {logging_mixin.py:190} INFO - Google Drive authentication successful!
[2024-10-15T21:43:24.445+0530] {logging_mixin.py:190} INFO - Deleting old files from Google Drive folder...
[2024-10-15T21:43:27.564+0530] {logging_mixin.py:190} INFO - Deleted file: waterfront_analysis_final.csv with ID: 106BCGpE2ed1W442JIC7qg7p7s-I1k4A3
[2024-10-15T21:43:28.493+0530] {logging_mixin.py:190} INFO - Deleted file: condition_distribution_final.csv with ID: 1z-M3ZIc_xMbdtsIzbif87x3ZClPQBPcr
[2024-10-15T21:43:29.430+0530] {logging_mixin.py:190} INFO - Deleted file: house_features_analysis_final.csv with ID: 1JpYav7dUVVTSJ0k5jczAbyAvXg2DSVcU
[2024-10-15T21:43:30.481+0530] {logging_mixin.py:190} INFO - Deleted file: price_stats_by_zipcode_final.csv with ID: 1q8O4SkrkjG50PAAZmba1MSz8wLN7kxZo
[2024-10-15T21:43:31.765+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:43:31.764+0530] {http.py:140} WARNING - Encountered 403 Forbidden with reason "insufficientFilePermissions"
[2024-10-15T21:43:31.765+0530] {logging_mixin.py:190} INFO - Error deleting files: <HttpError 403 when requesting https://www.googleapis.com/drive/v3/files/1t1u03ZTia-wSW2Y92aorcd9qEFKTHR5X? returned "The user does not have sufficient permissions for this file.". Details: "[{'message': 'The user does not have sufficient permissions for this file.', 'domain': 'global', 'reason': 'insufficientFilePermissions'}]">
[2024-10-15T21:43:31.765+0530] {logging_mixin.py:190} INFO - Uploading consolidated CSV files to Google Drive...
[2024-10-15T21:43:33.610+0530] {logging_mixin.py:190} INFO - Uploaded price_stats_by_zipcode_final.csv to Google Drive.
[2024-10-15T21:43:35.391+0530] {logging_mixin.py:190} INFO - Uploaded house_features_analysis_final.csv to Google Drive.
[2024-10-15T21:43:35.620+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:43:35.619+0530] {timeout.py:68} ERROR - Process timed out, PID: 16168
[2024-10-15T21:43:35.624+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:43:35.622+0530] {dagbag.py:387} ERROR - Failed to import: /home/vboxuser/airflow/dags/home_schedule_dag.py
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/vboxuser/airflow/dags/home_schedule_dag.py", line 8, in <module>
    from home_analytics import perform_analytics  # Adjust the import based on your file name
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 197, in <module>
    perform_analytics()
  File "/home/vboxuser/airflow/dags/home_analytics.py", line 190, in perform_analytics
    ).execute()
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 923, in execute
    resp, content = _retry_request(
  File "/home/vboxuser/.local/lib/python3.10/site-packages/googleapiclient/http.py", line 191, in _retry_request
    resp, content = http.request(uri, method, *args, **kwargs)
  File "/home/vboxuser/.local/lib/python3.10/site-packages/google_auth_httplib2.py", line 218, in request
    response, content = self.http.request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1725, in request
    (response, content) = self._request(
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1441, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "/usr/lib/python3/dist-packages/httplib2/__init__.py", line 1393, in _conn_request
    response = conn.getresponse()
  File "/usr/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/usr/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python3.10/http/client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/usr/lib/python3.10/ssl.py", line 1303, in recv_into
    return self.read(nbytes, buffer)
  File "/usr/lib/python3.10/ssl.py", line 1159, in read
    return self._sslobj.read(len, buffer)
  File "/usr/local/lib/python3.10/dist-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/vboxuser/airflow/dags/home_schedule_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.10.2/best-practices.html#reducing-dag-complexity, PID: 16168
[2024-10-15T21:43:35.624+0530] {processor.py:927} WARNING - No viable dags retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:43:35.651+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 30.050 seconds
[2024-10-15T21:44:14.045+0530] {processor.py:186} INFO - Started process (PID=16788) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:44:14.049+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:44:14.053+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:44:14.052+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:44:17.470+0530] {logging_mixin.py:190} INFO - Reading the CSV file...
[2024-10-15T21:44:23.162+0530] {logging_mixin.py:190} INFO - CSV file loaded successfully!
[2024-10-15T21:44:23.162+0530] {logging_mixin.py:190} INFO - DataFrame Schema:
[2024-10-15T21:44:23.165+0530] {logging_mixin.py:190} INFO - root
 |-- id: string (nullable = true)
 |-- date: string (nullable = true)
 |-- price: double (nullable = true)
 |-- bedrooms: string (nullable = true)
 |-- bathrooms: string (nullable = true)
 |-- sqft_living: string (nullable = true)
 |-- sqft_lot: string (nullable = true)
 |-- floors: string (nullable = true)
 |-- waterfront: string (nullable = true)
 |-- view: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- grade: string (nullable = true)
 |-- yr_built: string (nullable = true)
 |-- zipcode: string (nullable = true)
 |-- lat: string (nullable = true)
 |-- long: string (nullable = true)
[2024-10-15T21:44:23.165+0530] {logging_mixin.py:190} INFO - First few rows of the DataFrame:
[2024-10-15T21:44:23.484+0530] {logging_mixin.py:190} INFO - +----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|    price|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
|        id|           date|     NULL|bedrooms|bathrooms|sqft_living|sqft_lot|floors|waterfront|   view|condition|grade|yr_built|zipcode|    lat|    long|
| 629000615|20141022T000000|1495000.0|       4|     3.25|       3070|   10375|     2|        No|No View|  Average|   10|    1962|  98004|47.5862|-122.198|
|4141800215|20141126T000000|1495000.0|       4|     3.75|       3770|    4000|   2.5|        No|No View|Very Good|    9|    1916|  98122|47.6157|-122.287|
|6448000020|20150129T000000|1490000.0|       4|      2.5|       2420|   18480|     1|        No|No View|     Good|    9|    1967|  98004|47.6214|-122.227|
|9522300010|20150331T000000|1490000.0|       3|      3.5|       4560|   14608|     2|        No|Average|  Average|   12|    1990|  98034|47.6995|-122.228|
+----------+---------------+---------+--------+---------+-----------+--------+------+----------+-------+---------+-----+--------+-------+-------+--------+
only showing top 5 rows
[2024-10-15T21:44:24.128+0530] {logging_mixin.py:190} INFO - Calculating price statistics by zipcode...
[2024-10-15T21:44:25.332+0530] {logging_mixin.py:190} INFO - Price statistics saved to /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode
[2024-10-15T21:44:25.333+0530] {logging_mixin.py:190} INFO - Analyzing house features...
[2024-10-15T21:44:25.850+0530] {logging_mixin.py:190} INFO - House features analysis saved to /home/vboxuser/airflow/dags/analytics/house_features_analysis
[2024-10-15T21:44:25.850+0530] {logging_mixin.py:190} INFO - Analyzing condition and grade distribution...
[2024-10-15T21:44:26.805+0530] {logging_mixin.py:190} INFO - Condition and grade distribution saved to /home/vboxuser/airflow/dags/analytics/condition_distribution
[2024-10-15T21:44:26.806+0530] {logging_mixin.py:190} INFO - Analyzing waterfront properties...
[2024-10-15T21:44:28.018+0530] {logging_mixin.py:190} INFO - Waterfront analysis saved to /home/vboxuser/airflow/dags/analytics/waterfront_analysis
[2024-10-15T21:44:28.018+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv...
[2024-10-15T21:44:28.019+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/price_stats_by_zipcode_final.csv
[2024-10-15T21:44:28.019+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/house_features_analysis into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv...
[2024-10-15T21:44:28.019+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/house_features_analysis_final.csv
[2024-10-15T21:44:28.020+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/condition_distribution into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv...
[2024-10-15T21:44:28.020+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/condition_distribution_final.csv
[2024-10-15T21:44:28.020+0530] {logging_mixin.py:190} INFO - Consolidating CSV files from /home/vboxuser/airflow/dags/analytics/waterfront_analysis into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv...
[2024-10-15T21:44:28.026+0530] {logging_mixin.py:190} INFO - Consolidated files into /home/vboxuser/airflow/dags/analytics/waterfront_analysis_final.csv
[2024-10-15T21:44:28.026+0530] {logging_mixin.py:190} INFO - Integrating with Google Drive...
[2024-10-15T21:44:28.034+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:44:28.034+0530] {__init__.py:49} INFO - file_cache is only supported with oauth2client<4.0.0
[2024-10-15T21:44:28.050+0530] {logging_mixin.py:190} INFO - Google Drive authentication successful!
[2024-10-15T21:44:28.050+0530] {logging_mixin.py:190} INFO - Deleting old files from Google Drive folder...
[2024-10-15T21:44:31.560+0530] {logging_mixin.py:190} INFO - Deleted file: condition_distribution_final.csv with ID: 1S_DV1wVcU8AFQXfSCj2HLeezxZx5c1BH
[2024-10-15T21:44:32.308+0530] {logging_mixin.py:190} INFO - Deleted file: house_features_analysis_final.csv with ID: 1GdzK6bbH0Roh7D09i2ErD8QPR6O1MKfF
[2024-10-15T21:44:33.230+0530] {logging_mixin.py:190} INFO - Deleted file: price_stats_by_zipcode_final.csv with ID: 1-rw_LMvxfQw2B6S89Du8SKsCjaOHBVrp
[2024-10-15T21:44:34.210+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:44:34.210+0530] {http.py:140} WARNING - Encountered 403 Forbidden with reason "insufficientFilePermissions"
[2024-10-15T21:44:34.210+0530] {logging_mixin.py:190} INFO - Error deleting files: <HttpError 403 when requesting https://www.googleapis.com/drive/v3/files/1t1u03ZTia-wSW2Y92aorcd9qEFKTHR5X? returned "The user does not have sufficient permissions for this file.". Details: "[{'message': 'The user does not have sufficient permissions for this file.', 'domain': 'global', 'reason': 'insufficientFilePermissions'}]">
[2024-10-15T21:44:34.210+0530] {logging_mixin.py:190} INFO - Uploading consolidated CSV files to Google Drive...
[2024-10-15T21:44:36.668+0530] {logging_mixin.py:190} INFO - Uploaded price_stats_by_zipcode_final.csv to Google Drive.
[2024-10-15T21:44:38.352+0530] {logging_mixin.py:190} INFO - Uploaded house_features_analysis_final.csv to Google Drive.
[2024-10-15T21:44:40.195+0530] {logging_mixin.py:190} INFO - Uploaded condition_distribution_final.csv to Google Drive.
[2024-10-15T21:44:41.945+0530] {logging_mixin.py:190} INFO - Uploaded waterfront_analysis_final.csv to Google Drive.
[2024-10-15T21:44:41.951+0530] {processor.py:925} INFO - DAG(s) 'home_schedule_dag' retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:44:42.118+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:44:42.117+0530] {override.py:1901} INFO - Created Permission View: can delete on DAG:home_schedule_dag
[2024-10-15T21:44:42.129+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:44:42.128+0530] {override.py:1901} INFO - Created Permission View: can edit on DAG:home_schedule_dag
[2024-10-15T21:44:42.136+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:44:42.136+0530] {override.py:1901} INFO - Created Permission View: can read on DAG:home_schedule_dag
[2024-10-15T21:44:42.147+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:44:42.146+0530] {override.py:1901} INFO - Created Permission View: can delete on DAG Run:home_schedule_dag
[2024-10-15T21:44:42.154+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:44:42.154+0530] {override.py:1901} INFO - Created Permission View: can create on DAG Run:home_schedule_dag
[2024-10-15T21:44:42.165+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:44:42.165+0530] {override.py:1901} INFO - Created Permission View: menu access on DAG Run:home_schedule_dag
[2024-10-15T21:44:42.180+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:44:42.180+0530] {override.py:1901} INFO - Created Permission View: can read on DAG Run:home_schedule_dag
[2024-10-15T21:44:42.182+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:44:42.181+0530] {dag.py:3239} INFO - Sync 1 DAGs
[2024-10-15T21:44:42.207+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:44:42.207+0530] {dag.py:3262} INFO - Creating ORM DAG for home_schedule_dag
[2024-10-15T21:44:42.220+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:44:42.220+0530] {dag.py:4180} INFO - Setting next_dagrun for home_schedule_dag to 2024-10-14 00:00:00+00:00, run_after=2024-10-15 00:00:00+00:00
[2024-10-15T21:44:42.251+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 28.225 seconds
[2024-10-15T21:46:13.744+0530] {processor.py:186} INFO - Started process (PID=17817) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:46:13.747+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:46:13.749+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:46:13.748+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:46:13.754+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:46:13.753+0530] {dagbag.py:387} ERROR - Failed to import: /home/vboxuser/airflow/dags/home_schedule_dag.py
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/vboxuser/airflow/dags/home_schedule_dag.py", line 8, in <module>
    from home_analytics import perform_analytics  # Adjust the import based on your file name
ModuleNotFoundError: No module named 'home_analytics'
[2024-10-15T21:46:13.757+0530] {processor.py:927} WARNING - No viable dags retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:46:13.793+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 0.059 seconds
[2024-10-15T21:47:57.470+0530] {processor.py:186} INFO - Started process (PID=18337) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:47:57.472+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:47:57.474+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:47:57.473+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:47:57.485+0530] {processor.py:925} INFO - DAG(s) 'home_schedule_dag' retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:47:57.558+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:47:57.558+0530] {dag.py:3239} INFO - Sync 1 DAGs
[2024-10-15T21:47:57.576+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:47:57.575+0530] {dag.py:4180} INFO - Setting next_dagrun for home_schedule_dag to 2024-10-15 00:00:00+00:00, run_after=2024-10-16 00:00:00+00:00
[2024-10-15T21:47:57.597+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 0.132 seconds
[2024-10-15T21:49:37.941+0530] {processor.py:186} INFO - Started process (PID=19190) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:49:37.945+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:49:37.947+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:49:37.947+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:49:37.959+0530] {processor.py:925} INFO - DAG(s) 'home_schedule_dag' retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:49:37.973+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:49:37.973+0530] {dag.py:3239} INFO - Sync 1 DAGs
[2024-10-15T21:49:37.991+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:49:37.990+0530] {dag.py:4180} INFO - Setting next_dagrun for home_schedule_dag to 2024-10-15 00:00:00+00:00, run_after=2024-10-16 00:00:00+00:00
[2024-10-15T21:49:38.023+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 0.092 seconds
[2024-10-15T21:50:19.389+0530] {processor.py:186} INFO - Started process (PID=19328) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:50:19.391+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:50:19.393+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:50:19.393+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:50:19.405+0530] {processor.py:925} INFO - DAG(s) 'home_schedule_dag' retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:50:19.437+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:50:19.437+0530] {dag.py:3239} INFO - Sync 1 DAGs
[2024-10-15T21:50:19.462+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:50:19.462+0530] {dag.py:4180} INFO - Setting next_dagrun for home_schedule_dag to 2024-10-15 00:00:00+00:00, run_after=2024-10-16 00:00:00+00:00
[2024-10-15T21:50:19.485+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 0.110 seconds
[2024-10-15T21:50:50.156+0530] {processor.py:186} INFO - Started process (PID=19483) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:50:50.158+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:50:50.160+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:50:50.160+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:50:50.177+0530] {processor.py:925} INFO - DAG(s) 'home_schedule_dag' retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:50:50.191+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:50:50.191+0530] {dag.py:3239} INFO - Sync 1 DAGs
[2024-10-15T21:50:50.217+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:50:50.217+0530] {dag.py:4180} INFO - Setting next_dagrun for home_schedule_dag to 2024-10-15 00:00:00+00:00, run_after=2024-10-16 00:00:00+00:00
[2024-10-15T21:50:50.238+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 0.087 seconds
[2024-10-15T21:51:48.907+0530] {processor.py:186} INFO - Started process (PID=19559) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:51:48.913+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:51:48.916+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:51:48.915+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:51:48.931+0530] {processor.py:925} INFO - DAG(s) 'home_schedule_dag' retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:51:48.953+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:51:48.953+0530] {dag.py:3239} INFO - Sync 1 DAGs
[2024-10-15T21:51:48.977+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:51:48.976+0530] {dag.py:4180} INFO - Setting next_dagrun for home_schedule_dag to 2024-10-15 00:00:00+00:00, run_after=2024-10-16 00:00:00+00:00
[2024-10-15T21:51:48.997+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 0.099 seconds
[2024-10-15T21:57:55.910+0530] {processor.py:186} INFO - Started process (PID=20257) to work on /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:57:55.913+0530] {processor.py:914} INFO - Processing file /home/vboxuser/airflow/dags/home_schedule_dag.py for tasks to queue
[2024-10-15T21:57:55.916+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:57:55.915+0530] {dagbag.py:588} INFO - Filling up the DagBag from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:57:55.924+0530] {processor.py:925} INFO - DAG(s) 'home_schedule_dag' retrieved from /home/vboxuser/airflow/dags/home_schedule_dag.py
[2024-10-15T21:57:55.939+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:57:55.938+0530] {dag.py:3239} INFO - Sync 1 DAGs
[2024-10-15T21:57:55.958+0530] {logging_mixin.py:190} INFO - [2024-10-15T21:57:55.958+0530] {dag.py:4180} INFO - Setting next_dagrun for home_schedule_dag to 2024-10-15 00:00:00+00:00, run_after=2024-10-16 00:00:00+00:00
[2024-10-15T21:57:55.981+0530] {processor.py:208} INFO - Processing /home/vboxuser/airflow/dags/home_schedule_dag.py took 0.077 seconds
